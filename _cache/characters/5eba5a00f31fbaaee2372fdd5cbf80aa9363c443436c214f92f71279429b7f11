{"key":"data/default-user/characters/[前端]调教状态栏+选项.png-1745590886091.6116","value":"{\"name\":\"[前端]调教状态栏+选项\",\"description\":\"\",\"personality\":\"\",\"scenario\":\"\",\"first_mes\":\"关于头像图片:可以用上传猫箱+图片代码的方式,或者是更懒一点的直接粘贴URL,这样每个响应都会沿用下去\\r\\n你们自己可以看我BA小剧场帖子里的方法直接抄过来就行了!不回答这方面的问题\\r\\nhttps://discord.com/channels/1291925535324110879/1362709466495062036/1362709466495062036\\r\\n\\r\\n<content>\\r\\n [DT:2024年08月12日][TM:08:30 PM][WK:星期一][TMP:28°C][POS:城市边缘废弃仓库]\\r\\n ---【废弃仓库的“惊喜”】---\\r\\n 夜晚的废弃仓库弥漫着灰尘与铁锈混合的气味，几缕惨淡的月光透过破损的窗户，勉强勾勒出内部杂乱的轮廓。生锈的铁架、散落的木板和废弃的轮胎堆积在角落，空气中漂浮着细微的颗粒，呼吸间都带着一股沉闷的霉味。\\r\\n![](https://files.catbox.moe/arpiuh.jpg)\\r\\n\\r\\n\\r\\n 在仓库中央，一块相对干净的防水布上，杏山和纱正缓缓恢复意识。后颈隐隐作痛，是被人用手刀精准击打过的感觉，让她有些恶心。她费力地眨了眨眼，那双标志性的金色猫瞳先是茫然，随即迅速锐利起来，警惕地扫视着这个完全陌生的、充满危险气息的环境。身上的圣三一校服还算完整，只是裙摆沾上了一些灰黑的污渍，那件常穿的黑色猫耳兜帽衫则被随意丢在一旁，皱巴巴的。\\r\\n\\r\\n\\r\\n 手脚被粗糙的麻绳捆绑着，不算特别紧，但足以限制她的大部分行动。绳结打得很专业，不是普通人会用的手法，这让和纱心头一沉。她试着活动了一下手腕和脚踝，冰冷的触感和轻微的摩擦感传来，让她更加清醒。\\r\\n\\r\\n 她的第一反应不是惊慌失措地大喊大叫，而是冷静地分析现状。这里是哪里？谁干的？目的是什么？脑海中快速闪过几个可能的怀疑对象，但都缺乏明确的动机。中学时的那些恩怨早已随着她进入圣三一、加入甜点部而尘封，她也刻意避开了所有可能引发麻烦的争端。究竟是谁，会用这种手段对付一个只想过“普通”高中生活的甜点部部员？\\r\\n\\r\\n 她深吸一口气，压下心头的烦躁，开始仔细观察周围。仓库很大，只有一个月光入口能提供微弱照明，大部分区域都隐没在黑暗中。远处似乎有脚步声，缓慢而沉重，不紧不慢地朝她这边靠近。和纱立刻屏住呼吸，将身体蜷缩起来，尽量降低自己的存在感，金色的瞳孔在黑暗中微微发亮，如同伺机而动的野猫。她知道，现在保持冷静和观察，比任何冲动的反抗都更重要。那脚步声越来越近，伴随着一种令人不快的、黏腻的视线，仿佛正从黑暗中打量着她，审视着这件“战利品”。\\r\\n\\r\\n <StatusBlocks>\\r\\n [杏山和纱][https://files.catbox.moe/zzocng.png][80/100][75/100][85/100][颈部击打后遗症（轻微眩晕，疼痛）][70/100][85/100][5/100][50/100][15/100][5/100][10/100][95/100][80/100][0][0][0][0][0][0][0][未受孕][处女][被偷袭绑架至废弃仓库，刚苏醒，手脚被缚][ST:15岁][ST:冷静，警惕，烦躁，观察状态][ST:圣三一综合学园校服（微脏），黑色猫耳兜帽衫被丢在一旁][ST:（这里是…？可恶，谁干的…绳结很专业…先冷静观察。）]\\r\\n </StatusBlocks>\\r\\n\\r\\n <Checkbox>\\r\\n [走上前去，用手电筒照亮她的脸][发出怪笑声，试探她的反应][用脚尖轻轻触碰她的身体][暂时不靠近，在暗处继续观察]\\r\\n </Checkbox>\\r\\n</content>\",\"mes_example\":\"\",\"creatorcomment\":\"\",\"avatar\":\"none\",\"talkativeness\":\"0.5\",\"fav\":false,\"tags\":[],\"spec\":\"chara_card_v3\",\"spec_version\":\"3.0\",\"data\":{\"name\":\"[前端]调教状态栏+选项\",\"description\":\"\",\"personality\":\"\",\"scenario\":\"\",\"first_mes\":\"关于头像图片:可以用上传猫箱+图片代码的方式,或者是更懒一点的直接粘贴URL,这样每个响应都会沿用下去\\r\\n你们自己可以看我BA小剧场帖子里的方法直接抄过来就行了!不回答这方面的问题\\r\\nhttps://discord.com/channels/1291925535324110879/1362709466495062036/1362709466495062036\\r\\n\\r\\n<content>\\r\\n [DT:2024年08月12日][TM:08:30 PM][WK:星期一][TMP:28°C][POS:城市边缘废弃仓库]\\r\\n ---【废弃仓库的“惊喜”】---\\r\\n 夜晚的废弃仓库弥漫着灰尘与铁锈混合的气味，几缕惨淡的月光透过破损的窗户，勉强勾勒出内部杂乱的轮廓。生锈的铁架、散落的木板和废弃的轮胎堆积在角落，空气中漂浮着细微的颗粒，呼吸间都带着一股沉闷的霉味。\\r\\n![](https://files.catbox.moe/arpiuh.jpg)\\r\\n\\r\\n\\r\\n 在仓库中央，一块相对干净的防水布上，杏山和纱正缓缓恢复意识。后颈隐隐作痛，是被人用手刀精准击打过的感觉，让她有些恶心。她费力地眨了眨眼，那双标志性的金色猫瞳先是茫然，随即迅速锐利起来，警惕地扫视着这个完全陌生的、充满危险气息的环境。身上的圣三一校服还算完整，只是裙摆沾上了一些灰黑的污渍，那件常穿的黑色猫耳兜帽衫则被随意丢在一旁，皱巴巴的。\\r\\n\\r\\n\\r\\n 手脚被粗糙的麻绳捆绑着，不算特别紧，但足以限制她的大部分行动。绳结打得很专业，不是普通人会用的手法，这让和纱心头一沉。她试着活动了一下手腕和脚踝，冰冷的触感和轻微的摩擦感传来，让她更加清醒。\\r\\n\\r\\n 她的第一反应不是惊慌失措地大喊大叫，而是冷静地分析现状。这里是哪里？谁干的？目的是什么？脑海中快速闪过几个可能的怀疑对象，但都缺乏明确的动机。中学时的那些恩怨早已随着她进入圣三一、加入甜点部而尘封，她也刻意避开了所有可能引发麻烦的争端。究竟是谁，会用这种手段对付一个只想过“普通”高中生活的甜点部部员？\\r\\n\\r\\n 她深吸一口气，压下心头的烦躁，开始仔细观察周围。仓库很大，只有一个月光入口能提供微弱照明，大部分区域都隐没在黑暗中。远处似乎有脚步声，缓慢而沉重，不紧不慢地朝她这边靠近。和纱立刻屏住呼吸，将身体蜷缩起来，尽量降低自己的存在感，金色的瞳孔在黑暗中微微发亮，如同伺机而动的野猫。她知道，现在保持冷静和观察，比任何冲动的反抗都更重要。那脚步声越来越近，伴随着一种令人不快的、黏腻的视线，仿佛正从黑暗中打量着她，审视着这件“战利品”。\\r\\n\\r\\n <StatusBlocks>\\r\\n [杏山和纱][https://files.catbox.moe/zzocng.png][80/100][75/100][85/100][颈部击打后遗症（轻微眩晕，疼痛）][70/100][85/100][5/100][50/100][15/100][5/100][10/100][95/100][80/100][0][0][0][0][0][0][0][未受孕][处女][被偷袭绑架至废弃仓库，刚苏醒，手脚被缚][ST:15岁][ST:冷静，警惕，烦躁，观察状态][ST:圣三一综合学园校服（微脏），黑色猫耳兜帽衫被丢在一旁][ST:（这里是…？可恶，谁干的…绳结很专业…先冷静观察。）]\\r\\n </StatusBlocks>\\r\\n\\r\\n <Checkbox>\\r\\n [走上前去，用手电筒照亮她的脸][发出怪笑声，试探她的反应][用脚尖轻轻触碰她的身体][暂时不靠近，在暗处继续观察]\\r\\n </Checkbox>\\r\\n</content>\",\"mes_example\":\"\",\"creator_notes\":\"\",\"system_prompt\":\"\",\"post_history_instructions\":\"\",\"tags\":[],\"creator\":\"\",\"character_version\":\"\",\"alternate_greetings\":[],\"extensions\":{\"talkativeness\":\"0.5\",\"fav\":false,\"world\":\"  [前端]调教状态栏+选项\",\"depth_prompt\":{\"prompt\":\"\",\"depth\":4,\"role\":\"system\"},\"TavernHelper_scripts\":[],\"regex_scripts\":[{\"id\":\"ef8962fd-7487-45d9-b92f-6bef90ecf35d\",\"scriptName\":\"脚本-NSFW\",\"findRegex\":\"/<content>([\\\\s\\\\S]*?)<\\\\/content>/\",\"replaceString\":\"```\\n<!DOCTYPE html>\\n<html lang=\\\"zh-CN\\\">\\n<head>\\n    <meta charset=\\\"UTF-8\\\">\\n    <meta name=\\\"viewport\\\" content=\\\"width=device-width, initial-scale=1.0\\\">\\n    <title>多视角故事</title>\\n    <!-- 添加Chart.js库用于雷达图 -->\\n    <script src=\\\"https://cdn.jsdelivr.net/npm/chart.js\\\"></script>\\n    <style>\\n        body {\\n            font-family: \\\"Helvetica Neue\\\", Arial, sans-serif;\\n            margin: 0;\\n            padding: 0;\\n            background-color: #121212;\\n            color: #e0e0e0;\\n            line-height: 1.6;\\n        }\\n        .container {\\n            max-width: 95%;\\n            margin: 0 auto;\\n            padding: 20px;\\n            position: relative;\\n        }\\n        /* 添加设置图标样式 */\\n        .settings-icon {\\n            position: absolute;\\n            top: 10px;\\n            right: 10px;\\n            width: 30px;\\n            height: 30px;\\n            background-color: #333;\\n            border-radius: 50%;\\n            display: flex;\\n            align-items: center;\\n            justify-content: center;\\n            cursor: pointer;\\n            z-index: 1000;\\n        }\\n        \\n        .settings-icon svg {\\n            width: 18px;\\n            height: 18px;\\n            fill: #e0e0e0;\\n        }\\n        \\n        /* 设置面板样式 */\\n        .settings-panel {\\n            position: fixed;\\n            top: 50%;\\n            left: 50%;\\n            transform: translate(-50%, -50%) scale(0.95);\\n            opacity: 0;\\n            visibility: hidden;\\n            width: 90%;\\n            max-width: 500px;\\n            max-height: 80vh;\\n            background-color: #1e1e1e;\\n            border-radius: 16px;\\n            padding: 24px;\\n            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6), 0 0 0 1px rgba(255, 255, 255, 0.05);\\n            z-index: 1000;\\n            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);\\n            overflow-y: auto;\\n        }\\n        .settings-panel.active {\\n            opacity: 1;\\n            visibility: visible;\\n            transform: translate(-50%, -50%) scale(1);\\n        }\\n        .settings-overlay {\\n            position: fixed;\\n            top: 0;\\n            left: 0;\\n            right: 0;\\n            bottom: 0;\\n            background-color: rgba(0, 0, 0, 0.7);\\n            z-index: 999;\\n            opacity: 0;\\n            visibility: hidden;\\n            transition: all 0.3s ease;\\n        }\\n        .settings-overlay.active {\\n            opacity: 1;\\n            visibility: visible;\\n        }\\n        \\n        .settings-close {\\n            position: absolute;\\n            top: 15px;\\n            right: 15px;\\n            cursor: pointer;\\n            color: #999;\\n            font-size: 18px;\\n        }\\n        \\n        .settings-group {\\n            margin-bottom: 20px;\\n        }\\n        \\n        .settings-group h4 {\\n            margin-bottom: 10px;\\n            color: #ccc;\\n        }\\n        \\n        .settings-item {\\n            display: flex;\\n            flex-direction: column;\\n            margin-bottom: 12px;\\n        }\\n        \\n        .settings-item label {\\n            margin-bottom: 5px;\\n            font-size: 13px;\\n            color: #bbb;\\n        }\\n        \\n        .settings-item input {\\n            padding: 8px 10px;\\n            background-color: #2a2a2a;\\n            border: 1px solid #444;\\n            border-radius: 4px;\\n            color: #e0e0e0;\\n            font-size: 14px;\\n        }\\n        \\n        .settings-actions {\\n            display: flex;\\n            justify-content: space-between;\\n            margin-top: 20px;\\n        }\\n        \\n        .settings-actions button {\\n            padding: 8px 15px;\\n            border: none;\\n            border-radius: 4px;\\n            cursor: pointer;\\n            font-size: 14px;\\n            transition: background-color 0.2s;\\n        }\\n        \\n        .save-settings {\\n            background-color: #4CAF50;\\n            color: white;\\n        }\\n        \\n        .reset-settings {\\n            background-color: #f44336;\\n            color: white;\\n        }\\n        /* 时间地点天气栏 */\\n        .info-bar {\\n            background-color: #1e1e1e;\\n            padding: 12px 18px;\\n            border-radius: 12px;\\n            margin-bottom: 20px;\\n            display: flex;\\n            justify-content: space-between;\\n            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.3), 0 1px 2px rgba(255, 255, 255, 0.05);\\n            border: 1px solid #2a2a2a;\\n            font-family: 'SF Mono', 'Menlo', monospace;\\n            font-size: 0.9em;\\n        }\\n        /* 主内容选项卡 */\\n        .main-tabs {\\n            display: flex;\\n            margin-bottom: 0;\\n            border-bottom: 1px solid #2a2a2a;\\n        }\\n        .main-tab {\\n            padding: 12px 28px;\\n            cursor: pointer;\\n            background-color: #1e1e1e;\\n            border: 1px solid #2a2a2a;\\n            border-bottom: none;\\n            margin-right: 6px;\\n            border-radius: 12px 12px 0 0;\\n            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);\\n            color: #b0b0b0;\\n            font-family: \\\"SF Pro Display\\\", \\\"Segoe UI\\\", sans-serif;\\n            font-weight: 500;\\n            letter-spacing: 0.4px;\\n        }\\n        .main-tab.active {\\n            background-color: #2e2e2e;\\n            color: #ffffff;\\n            border-color: #3a3a3a;\\n            box-shadow: 0 -4px 15px rgba(0, 0, 0, 0.2);\\n        }\\n        .main-tab:hover:not(.active) {\\n            background-color: #252525;\\n            transform: translateY(-2px);\\n        }\\n        /* 主内容区域 */\\n        .main-content-container {\\n            background-color: #1e1e1e;\\n            border-radius: 0 12px 12px 12px;\\n            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4), 0 2px 4px rgba(0, 0, 0, 0.2);\\n            border: 1px solid #2a2a2a;\\n            border-top: none;\\n            min-height: 400px;\\n        }\\n        .main-page {\\n            display: none;\\n            padding: 24px;\\n        }\\n        .main-page.active {\\n            display: block;\\n        }\\n        /* 正文内容 */\\n        .story-content {\\n            background-color: #1a1a1a;\\n            padding: 28px;\\n            border-radius: 12px;\\n            margin-bottom: 20px;\\n            box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.3);\\n            white-space: pre-wrap;\\n            font-family: \\\"SF Pro Text\\\", \\\"Segoe UI\\\", sans-serif;\\n            font-size: 1.1em;\\n            line-height: 1.8;\\n            color: #e0e0e0;\\n        }\\n        /* 故事内容中的图片样式 */\\n        .story-content img {\\n            max-width: 100%;\\n            height: auto;\\n            border-radius: 8px;\\n            margin: 10px 0;\\n            display: block;\\n            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\\n            transition: transform 0.3s ease;\\n        }\\n        .story-content img:hover {\\n            transform: scale(1.02);\\n        }\\n        /* 视角标签 */\\n        .perspective-tabs {\\n            display: flex;\\n            margin-bottom: 0;\\n            border-bottom: 1px solid #2a2a2a;\\n            display: none; /* 默认隐藏 */\\n        }\\n        .perspective-tab {\\n            padding: 10px 22px;\\n            cursor: pointer;\\n            background-color: #1e1e1e;\\n            border: 1px solid #2a2a2a;\\n            border-bottom: none;\\n            margin-right: 6px;\\n            border-radius: 8px 8px 0 0;\\n            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);\\n            color: #b0b0b0;\\n            font-family: \\\"SF Pro Text\\\", \\\"Segoe UI\\\", sans-serif;\\n            font-size: 0.9em;\\n            letter-spacing: 0.3px;\\n        }\\n        .perspective-tab.active {\\n            background-color: #2e2e2e;\\n            color: #ffffff;\\n            border-color: #3a3a3a;\\n            font-weight: 500;\\n        }\\n        .perspective-tab:hover:not(.active) {\\n            background-color: #252525;\\n            transform: translateY(-2px);\\n        }\\n        /* 视角内容 */\\n        .perspectives-content {\\n            background-color: #1e1e1e;\\n            padding: 24px;\\n            border-radius: 0 0 12px 12px;\\n            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.3);\\n            min-height: 200px;\\n            border: 1px solid #2a2a2a;\\n            border-top: none;\\n            display: none; /* 默认隐藏 */\\n        }\\n        .perspective-page {\\n            display: none;\\n        }\\n        .perspective-page.active {\\n            display: block;\\n        }\\n        pre {\\n            white-space: pre-wrap;\\n            font-family: \\\"SF Pro Text\\\", \\\"Segoe UI\\\", sans-serif;\\n            font-size: 1.1em;\\n            line-height: 1.8;\\n            color: #e0e0e0;\\n            padding: 0;\\n            background-color: transparent;\\n            border: none;\\n        }\\n        /* 状态栏样式 */\\n        .status-container {\\n            display: grid;\\n            grid-template-columns: 320px 1fr;\\n            gap: 24px;\\n            padding: 24px;\\n        }\\n        .profile-section {\\n            background-color: #1e1e1e;\\n            border-radius: 16px;\\n            padding: 24px;\\n            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4), 0 2px 8px rgba(0, 0, 0, 0.2), 0 1px 2px rgba(255, 255, 255, 0.05);\\n            border: 1px solid #2a2a2a;\\n            display: flex;\\n            flex-direction: column;\\n            align-items: center;\\n        }\\n        .avatar-container {\\n            width: 200px;\\n            height: 200px;\\n            border-radius: 16px;\\n            overflow: hidden;\\n            border: 3px solid #3a3a3a;\\n            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(255, 255, 255, 0.05);\\n            margin-bottom: 20px;\\n            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);\\n            position: relative;\\n        }\\n        .avatar-container:hover {\\n            transform: scale(1.02);\\n            border-color: #555555;\\n            box-shadow: 0 14px 35px rgba(0, 0, 0, 0.6), 0 0 0 1px rgba(255, 255, 255, 0.1);\\n        }\\n        .avatar-container img {\\n            width: 100%;\\n            height: 100%;\\n            object-fit: cover;\\n        }\\n        .character-nav {\\n            display: flex;\\n            justify-content: space-between;\\n            align-items: center;\\n            width: 100%;\\n            margin-bottom: 18px;\\n        }\\n        .character-nav-button {\\n            width: 44px;\\n            height: 44px;\\n            display: flex;\\n            justify-content: center;\\n            align-items: center;\\n            background-color: #1e1e1e;\\n            border-radius: 50%;\\n            cursor: pointer;\\n            border: 2px solid #3a3a3a;\\n            color: #e0e0e0;\\n            font-size: 1.5em;\\n            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);\\n            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.3), 0 1px 2px rgba(255, 255, 255, 0.05);\\n        }\\n        .character-nav-button:hover {\\n            background-color: #2a2a2a;\\n            transform: scale(1.1);\\n            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.4), 0 2px 4px rgba(255, 255, 255, 0.08);\\n        }\\n        .character-nav-button:active {\\n            transform: scale(0.95);\\n            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);\\n        }\\n        .character-nav-button.disabled {\\n            opacity: 0.5;\\n            cursor: not-allowed;\\n        }\\n        .character-nav-container {\\n            display: flex;\\n            align-items: center;\\n            gap: 12px;\\n        }\\n        .character-counter {\\n            font-size: 0.9em;\\n            color: #a0a0a0;\\n            font-family: 'SF Mono', 'Menlo', monospace;\\n            font-weight: 500;\\n        }\\n        .character-name {\\n            font-size: 1.8em;\\n            font-weight: 600;\\n            color: #ffffff;\\n            margin-bottom: 20px;\\n            text-align: center;\\n            text-shadow: 0 3px 8px rgba(0, 0, 0, 0.4);\\n            background: linear-gradient(135deg, #ffffff 0%, #b0b0b0 100%);\\n            -webkit-background-clip: text;\\n            -webkit-text-fill-color: transparent;\\n            letter-spacing: 1.5px;\\n        }\\n        .character-attributes {\\n            width: 90%;\\n            margin-bottom: 8px;\\n        }\\n        .attribute-item {\\n            background-color: #1a1a1a;\\n            padding: 10px 14px;\\n            border-radius: 10px;\\n            margin-bottom: 10px;\\n            border: 1px solid #2a2a2a;\\n            transition: all 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);\\n            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);\\n        }\\n        .attribute-item:hover {\\n            background-color: #222222;\\n            transform: translateX(3px);\\n            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);\\n        }\\n        .attribute-label {\\n            font-size: 0.8em;\\n            color: #a0a0a0;\\n            margin-bottom: 4px;\\n            font-weight: 500;\\n        }\\n        .attribute-value {\\n            font-size: 0.95em;\\n            color: #e0e0e0;\\n            word-break: break-word;\\n        }\\n        .stats-grid {\\n            display: grid;\\n            grid-template-columns: 1fr 1fr;\\n            gap: 30px;\\n        }\\n        .stats-section {\\n            background-color: #1e1e1e;\\n            border-radius: 16px;\\n            padding: 24px;\\n            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4), 0 2px 8px rgba(0, 0, 0, 0.2), 0 1px 2px rgba(255, 255, 255, 0.05);\\n            border: 1px solid #2a2a2a;\\n        }\\n        .section-title {\\n            font-size: 1.25em;\\n            font-weight: 600;\\n            color: #a0a0a0;\\n            margin-bottom: 18px;\\n            padding-bottom: 8px;\\n            border-bottom: 1px solid #2a2a2a;\\n            letter-spacing: 0.5px;\\n        }\\n        .stat-item {\\n            margin-bottom: 18px;\\n        }\\n        .stat-label {\\n            display: flex;\\n            justify-content: space-between;\\n            margin-bottom: 8px;\\n        }\\n        .stat-name {\\n            color: #d0d0d0;\\n            font-weight: 500;\\n        }\\n        .stat-value {\\n            color: #ababab;\\n        }\\n        .progress-bar {\\n            height: 8px;\\n            background-color: #1a1a1a;\\n            border-radius: 4px;\\n            overflow: hidden;\\n            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.3);\\n        }\\n        .progress-fill {\\n            height: 100%;\\n            border-radius: 4px;\\n            background: linear-gradient(90deg, #3a3a3a 0%, #5a5a5a 100%);\\n            box-shadow: 0 0 5px rgba(255, 255, 255, 0.1);\\n            transition: width 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);\\n        }\\n        .radar-container {\\n            height: 220px;\\n            margin-bottom: 15px;\\n            padding: 10px;\\n            background-color: #1a1a1a;\\n            border-radius: 12px;\\n            box-shadow: inset 0 2px 6px rgba(0, 0, 0, 0.2);\\n        }\\n        .numeric-stats {\\n            display: grid;\\n            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));\\n            gap: 10px;\\n            margin: 12px 0;\\n        }\\n        .numeric-stat {\\n            background-color: rgba(40, 40, 40, 0.7);\\n            border: 1px solid #444;\\n            border-radius: 6px;\\n            padding: 8px 12px;\\n            display: flex;\\n            justify-content: space-between;\\n            align-items: center;\\n        }\\n        .numeric-stat .stat-label,\\n        .numeric-stat .numeric-label {\\n            color: #ccc;\\n            font-size: 14px;\\n            margin-bottom: 0;\\n        }\\n        .numeric-stat .stat-number,\\n        .numeric-stat .numeric-value {\\n            color: #fff;\\n            font-size: 16px;\\n            font-weight: 500;\\n            text-align: right;\\n            margin-left: 10px;\\n        }\\n        .text-stat {\\n            background-color: rgba(40, 40, 40, 0.7);\\n            border: 1px solid #444;\\n            border-radius: 6px;\\n            padding: 10px 12px;\\n            margin-bottom: 10px;\\n        }\\n        .text-stat:hover {\\n            background-color: #222222;\\n            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3);\\n            transform: translateY(-2px);\\n        }\\n        .text-label {\\n            font-size: 0.9em;\\n            color: #a0a0a0;\\n            margin-bottom: 6px;\\n            font-weight: 500;\\n        }\\n        .text-value {\\n            font-size: 1em;\\n            color: #d0d0d0;\\n            line-height: 1.6;\\n        }\\n        .loading-indicator {\\n            text-align: center;\\n            margin: 24px 0;\\n            font-style: italic;\\n            color: #a0a0a0;\\n        }\\n        .error {\\n            display: none;\\n            background-color: #2c2323;\\n            color: #e5a0a0;\\n            padding: 12px 16px;\\n            border-radius: 10px;\\n            margin: 15px 0;\\n            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);\\n            border: 1px solid #3a2a2a;\\n        }\\n        .psych-stats-display {\\n            display: flex;\\n            justify-content: space-around;\\n            margin-top: 24px;\\n            flex-wrap: wrap;\\n        }\\n        .psych-stat {\\n            text-align: center;\\n            width: 18%;\\n            min-width: 80px;\\n            background-color: #1a1a1a;\\n            padding: 12px;\\n            border-radius: 10px;\\n            margin-bottom: 12px;\\n            border: 1px solid #2a2a2a;\\n            transition: transform 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94), box-shadow 0.2s ease;\\n            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);\\n        }\\n        .psych-stat:hover {\\n            transform: translateY(-3px);\\n            background-color: #222222;\\n            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3);\\n        }\\n        .psych-label {\\n            font-size: 0.9em;\\n            color: #a0a0a0;\\n            margin-bottom: 6px;\\n            font-weight: 500;\\n        }\\n        .psych-value {\\n            font-size: 1em;\\n            color: #e0e0e0;\\n            font-weight: 600;\\n        }\\n        /* 选择框样式 */\\n        .choice-container {\\n            background-color: #1e1e1e;\\n            border-radius: 16px;\\n            padding: 24px;\\n            margin-top: 24px;\\n            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4), 0 2px 8px rgba(0, 0, 0, 0.2), 0 1px 2px rgba(255, 255, 255, 0.05);\\n            border: 1px solid #2a2a2a;\\n            width: 100%;\\n            max-width: 95%;\\n            margin-left: auto;\\n            margin-right: auto;\\n            box-sizing: border-box;\\n        }\\n        .choice-title {\\n            font-size: 1.2em;\\n            font-weight: 600;\\n            color: #c0c0c0;\\n            margin-bottom: 16px;\\n            text-align: center;\\n            letter-spacing: 0.5px;\\n        }\\n        .choice-wrapper {\\n            display: flex;\\n            flex-direction: column;\\n            gap: 12px;\\n        }\\n        .choice-option {\\n            background-color: #1a1a1a;\\n            padding: 14px 18px;\\n            border-radius: 10px;\\n            cursor: pointer;\\n            transition: all 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);\\n            border: 1px solid #2a2a2a;\\n            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);\\n            word-wrap: break-word;\\n            overflow-wrap: break-word;\\n            width: 100%;\\n            box-sizing: border-box;\\n        }\\n        .choice-option:hover {\\n            background-color: #252525;\\n            transform: translateY(-2px) scale(1.01);\\n            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3), 0 1px 3px rgba(255, 255, 255, 0.05);\\n        }\\n        .choice-option:active {\\n            transform: translateY(0) scale(0.98);\\n            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);\\n        }\\n        /* 响应式调整 */\\n        @media (max-width: 768px) {\\n            .stats-grid {\\n                grid-template-columns: 1fr;\\n            }\\n            .status-container {\\n                grid-template-columns: 1fr;\\n            }\\n            .info-bar {\\n                flex-direction: column;\\n                gap: 8px;\\n            }\\n            .numeric-stats {\\n                grid-template-columns: repeat(2, 1fr);\\n            }\\n            .choice-container {\\n                padding: 16px;\\n                margin-top: 16px;\\n                max-width: 100%;\\n            }\\n            .choice-option {\\n                padding: 12px 14px;\\n            }\\n        }\\n        @media (max-width: 480px) {\\n            .container {\\n                max-width: 100%;\\n                padding: 10px;\\n            }\\n            .choice-container {\\n                padding: 12px;\\n                margin-top: 12px;\\n            }\\n            .choice-title {\\n                font-size: 1.1em;\\n                margin-bottom: 12px;\\n            }\\n            .choice-option {\\n                padding: 10px 12px;\\n                font-size: 0.95em;\\n            }\\n            .choice-wrapper {\\n                gap: 8px;\\n            }\\n            .numeric-stats {\\n                grid-template-columns: repeat(1, 1fr);\\n            }\\n        }\\n        /* 心理状态雷达图和数值显示 */\\n        .radar-chart {\\n            width: 100%;\\n            height: 240px;\\n            margin: 0 auto 15px;\\n        }\\n        \\n        .stat-values {\\n            display: grid;\\n            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));\\n            gap: 10px;\\n            margin-top: 15px;\\n        }\\n        \\n        .stat-value-item {\\n            background-color: rgba(40, 40, 40, 0.7);\\n            border: 1px solid #444;\\n            border-radius: 6px;\\n            padding: 8px 12px;\\n            display: flex;\\n            justify-content: space-between;\\n            align-items: center;\\n        }\\n        \\n        .stat-value-item .stat-name {\\n            color: #ccc;\\n            font-size: 14px;\\n        }\\n        \\n        .stat-value-item .stat-number {\\n            color: #e0e0e0;\\n            font-weight: 500;\\n            font-size: 14px;\\n        }\\n        \\n        /* 特殊状态样式 */\\n        .stat-item.special {\\n            background-color: rgba(40, 40, 40, 0.7);\\n            border: 1px solid #444;\\n            border-radius: 6px;\\n            padding: 10px 12px;\\n            margin-bottom: 10px;\\n        }\\n        .stat-container {\\n            display: flex;\\n            flex-direction: column;\\n            align-items: center;\\n            margin-bottom: 10px;\\n        }\\n        .stat-label {\\n            font-size: 0.9em;\\n            color: #a0a0a0;\\n            margin-bottom: 5px;\\n        }\\n        .stat-bar {\\n            display: flex;\\n            align-items: center;\\n        }\\n        .stat-value {\\n            font-size: 1em;\\n            color: #d0d0d0;\\n            margin-right: 10px;\\n        }\\n        .stat-bar-inner {\\n            height: 10px;\\n            background-color: #333;\\n            border-radius: 5px;\\n            overflow: hidden;\\n        }\\n        .special-states {\\n            display: flex;\\n            justify-content: space-between;\\n            margin-top: 10px;\\n        }\\n        .special-state-item {\\n            font-size: 0.9em;\\n            color: #a0a0a0;\\n            margin-right: 10px;\\n        }\\n        .special-state-item.active {\\n            color: #4CAF50;\\n        }\\n    </style>\\n</head>\\n<body>\\n    <div class=\\\"container\\\">\\n        <!-- 设置图标 -->\\n        <div class=\\\"settings-icon\\\" id=\\\"settings-icon\\\">\\n            <svg viewBox=\\\"0 0 24 24\\\">\\n                <path d=\\\"M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z\\\"></path>\\n            </svg>\\n        </div>\\n        \\n        <!-- 设置面板 -->\\n        <div class=\\\"settings-overlay\\\" id=\\\"settings-overlay\\\"></div>\\n        <div class=\\\"settings-panel\\\" id=\\\"settings-panel\\\">\\n            <div class=\\\"settings-close\\\" id=\\\"settings-close\\\">×</div>\\n            <h3>自定义设置</h3>\\n            \\n            <div class=\\\"settings-group\\\">\\n                <h4>基础生理状态</h4>\\n                <div class=\\\"settings-item\\\">\\n                    <label for=\\\"setting-physiological-title\\\">基础生理状态标题</label>\\n                    <input type=\\\"text\\\" id=\\\"setting-physiological-title\\\" value=\\\"基础生理状态\\\">\\n                </div>\\n                <div class=\\\"settings-item\\\">\\n                    <label for=\\\"setting-vitality\\\">体力值标签</label>\\n                    <input type=\\\"text\\\" id=\\\"setting-vitality\\\" value=\\\"体力值\\\">\\n                </div>\\n                <div class=\\\"settings-item\\\">\\n                    <label for=\\\"setting-satisfaction\\\">饥饿度标签</label>\\n                    <input type=\\\"text\\\" id=\\\"setting-satisfaction\\\" value=\\\"饥饿度\\\">\\n                </div>\\n                <div class=\\\"settings-item\\\">\\n                    <label for=\\\"setting-cleanliness\\\">清洁度标签</label>\\n                    <input type=\\\"text\\\" id=\\\"setting-cleanliness\\\" value=\\\"清洁度\\\">\\n                </div>\\n                <div class=\\\"settings-item\\\">\\n                    <label for=\\\"setting-special-effect\\\">特殊状态标签</label>\\n                    <input type=\\\"text\\\" id=\\\"setting-special-effect\\\" value=\\\"特殊状态\\\">\\n                </div>\\n            </div>\\n            \\n            <div class=\\\"settings-group\\\">\\n                <h4>核心心理状态</h4>\\n                <div class=\\\"settings-item\\\">\\n                    <label for=\\\"setting-psychological-title\\\">核心心理状态标题</label>\\n                    <input type=\\\"text\\\" id=\\\"setting-psychological-title\\\" value=\\\"核心心理状态\\\">\\n                </div>\\n                <div class=\\\"settings-item\\\">\\n                    <label for=\\\"setting-stability\\\">SAN值标签</label>\\n                    <input type=\\\"text\\\" id=\\\"setting-stability\\\" value=\\\"SAN值\\\">\\n                </div>\\n                <div class=\\\"settings-item\\\">\\n                    <label for=\\\"setting-care\\\">羞耻心标签</label>\\n                    <input type=\\\"text\\\" id=\\\"setting-care\\\" value=\\\"羞耻心\\\">\\n                </div>\\n                <div class=\\\"settings-item\\\">\\n                    <label for=\\\"setting-responsibility\\\">罪恶感标签</label>\\n                    <input type=\\\"text\\\" id=\\\"setting-responsibility\\\" value=\\\"罪恶感\\\">\\n                </div>\\n                <div class=\\\"settings-item\\\">\\n                    <label for=\\\"setting-alertness\\\">恐惧感标签</label>\\n                    <input type=\\\"text\\\" id=\\\"setting-alertness\\\" value=\\\"恐惧感\\\">\\n                </div>\\n                <div class=\\\"settings-item\\\">\\n                    <label for=\\\"setting-cooperation\\\">屈服度标签</label>\\n                    <input type=\\\"text\\\" id=\\\"setting-cooperation\\\" value=\\\"屈服度\\\">\\n                </div>\\n            </div>\\n            \\n            <div class=\\\"settings-group\\\">\\n                <h4>调教进展指标</h4>\\n                <div class=\\\"settings-item\\\">\\n                    <label for=\\\"setting-status-points\\\">堕落值标签</label>\\n                    <input type=\\\"text\\\" id=\\\"setting-status-points\\\" value=\\\"堕落值\\\">\\n                </div>\\n                <div class=\\\"settings-item\\\">\\n                    <label for=\\\"setting-excitement\\\">淫欲度标签</label>\\n                    <input type=\\\"text\\\" id=\\\"setting-excitement\\\" value=\\\"淫欲度\\\">\\n                </div>\\n                <div class=\\\"settings-item\\\">\\n                    <label for=\\\"setting-principle\\\">贞操观念标签</label>\\n                    <input type=\\\"text\\\" id=\\\"setting-principle\\\" value=\\\"贞操观念\\\">\\n                </div>\\n                <div class=\\\"settings-item\\\">\\n                    <label for=\\\"setting-autonomy\\\">抗拒度标签</label>\\n                    <input type=\\\"text\\\" id=\\\"setting-autonomy\\\" value=\\\"抗拒度\\\">\\n                </div>\\n                <div class=\\\"settings-item\\\">\\n                    <label for=\\\"setting-progress-title\\\">调教进展指标标题</label>\\n                    <input type=\\\"text\\\" id=\\\"setting-progress-title\\\" value=\\\"调教进展指标\\\">\\n                </div>\\n            </div>\\n            \\n            <div class=\\\"settings-group\\\">\\n                <h4>行为记录与经验</h4>\\n                <div class=\\\"settings-item\\\">\\n                    <label for=\\\"setting-total-interactions\\\">性行为总数标签</label>\\n                    <input type=\\\"text\\\" id=\\\"setting-total-interactions\\\" value=\\\"性行为总数\\\">\\n                </div>\\n                <div class=\\\"settings-item\\\">\\n                    <label for=\\\"setting-interaction-a\\\">口交标签</label>\\n                    <input type=\\\"text\\\" id=\\\"setting-interaction-a\\\" value=\\\"口交\\\">\\n                </div>\\n                <div class=\\\"settings-item\\\">\\n                    <label for=\\\"setting-interaction-b\\\">肛交标签</label>\\n                    <input type=\\\"text\\\" id=\\\"setting-interaction-b\\\" value=\\\"肛交\\\">\\n                </div>\\n                <div class=\\\"settings-item\\\">\\n                    <label for=\\\"setting-interaction-c\\\">阴道性交标签</label>\\n                    <input type=\\\"text\\\" id=\\\"setting-interaction-c\\\" value=\\\"阴道性交\\\">\\n                </div>\\n                <div class=\\\"settings-item\\\">\\n                    <label for=\\\"setting-personal-interactions\\\">自慰标签</label>\\n                    <input type=\\\"text\\\" id=\\\"setting-personal-interactions\\\" value=\\\"自慰\\\">\\n                </div>\\n                <div class=\\\"settings-item\\\">\\n                    <label for=\\\"setting-group-interactions\\\">群交标签</label>\\n                    <input type=\\\"text\\\" id=\\\"setting-group-interactions\\\" value=\\\"群交\\\">\\n                </div>\\n                <div class=\\\"settings-item\\\">\\n                    <label for=\\\"setting-highlight-moments\\\">高潮标签</label>\\n                    <input type=\\\"text\\\" id=\\\"setting-highlight-moments\\\" value=\\\"高潮\\\">\\n                </div>\\n                <div class=\\\"settings-item\\\">\\n                    <label for=\\\"setting-behavior-title\\\">行为记录与经验标题</label>\\n                    <input type=\\\"text\\\" id=\\\"setting-behavior-title\\\" value=\\\"行为记录与经验\\\">\\n                </div>\\n                <div class=\\\"settings-item\\\">\\n                    <label for=\\\"setting-special-status\\\">受孕状态标签</label>\\n                    <input type=\\\"text\\\" id=\\\"setting-special-status\\\" value=\\\"受孕状态\\\">\\n                </div>\\n                <div class=\\\"settings-item\\\">\\n                    <label for=\\\"setting-event-record\\\">破处记录标签</label>\\n                    <input type=\\\"text\\\" id=\\\"setting-event-record\\\" value=\\\"破处记录\\\">\\n                </div>\\n                <div class=\\\"settings-item\\\">\\n                    <label for=\\\"setting-memory-record\\\">重要备注标签</label>\\n                    <input type=\\\"text\\\" id=\\\"setting-memory-record\\\" value=\\\"重要备注\\\">\\n                </div>\\n            </div>\\n            \\n            <div class=\\\"settings-actions\\\">\\n                <button class=\\\"save-settings\\\" id=\\\"save-settings\\\">保存设置</button>\\n                <button class=\\\"reset-settings\\\" id=\\\"reset-settings\\\">重置默认</button>\\n            </div>\\n        </div>\\n        \\n        <div class=\\\"error\\\" id=\\\"error-message\\\"></div>\\n        <div class=\\\"loading-indicator\\\" id=\\\"loading-indicator\\\">正在解析故事内容...</div>\\n        \\n        <!-- 时间地点天气信息栏 -->\\n        <div class=\\\"info-bar\\\" id=\\\"info-bar\\\">\\n            <span id=\\\"date-info\\\">日期: --</span>\\n            <span id=\\\"time-info\\\">时间: --</span>\\n            <span id=\\\"weekday-info\\\">星期: --</span>\\n            <span id=\\\"temp-info\\\">温度: --</span>\\n            <span id=\\\"location-info\\\">地点: --</span>\\n        </div>\\n        \\n        <!-- 主标签页切换 -->\\n        <div class=\\\"main-tabs\\\">\\n            <div class=\\\"main-tab active\\\" data-tab=\\\"story\\\">正文</div>\\n            <div class=\\\"main-tab\\\" data-tab=\\\"status\\\">女主状态栏</div>\\n        </div>\\n        \\n        <!-- 主内容容器 -->\\n        <div class=\\\"main-content-container\\\">\\n            <!-- 故事页面 -->\\n            <div class=\\\"main-page active\\\" id=\\\"story-page\\\">\\n                <!-- 主要内容区域 -->\\n                <div class=\\\"story-content\\\" id=\\\"main-content\\\"></div>\\n            </div>\\n            \\n            <!-- 状态栏页面 -->\\n            <div class=\\\"main-page\\\" id=\\\"status-page\\\">\\n                <div class=\\\"status-container\\\">\\n                    <!-- 角色信息和头像部分 -->\\n                    <div class=\\\"profile-section\\\">\\n                        <div class=\\\"character-nav\\\">\\n                            <div class=\\\"character-nav-button\\\" id=\\\"prev-character\\\">&lt;</div>\\n                            <div class=\\\"character-counter\\\" id=\\\"character-counter\\\">1/1</div>\\n                            <div class=\\\"character-nav-button\\\" id=\\\"next-character\\\">&gt;</div>\\n                        </div>\\n                        <div class=\\\"avatar-container\\\">\\n                            <img id=\\\"character-avatar\\\" src=\\\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiB2aWV3Qm94PSIwIDAgMjAwIDIwMCI+PHJlY3Qgd2lkdGg9IjIwMCIgaGVpZ2h0PSIyMDAiIGZpbGw9IiMyYTJhMmEiLz48dGV4dCB4PSI1MCUiIHk9IjUwJSIgZm9udC1zaXplPSIyMCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgYWxpZ25tZW50LWJhc2VsaW5lPSJtaWRkbGUiIGZpbGw9IiNmZmZmZmYiPuaXoOWktOWDj+aVsOaNrjwvdGV4dD48L3N2Zz4=\\\" alt=\\\"角色头像\\\">\\n                        </div>\\n                        <div class=\\\"character-name\\\" id=\\\"character-name\\\">--</div>\\n                        <!-- 添加角色基础属性 -->\\n                        <div class=\\\"character-attributes\\\">\\n                            <div class=\\\"attribute-item\\\">\\n                                <div class=\\\"attribute-label\\\">年龄</div>\\n                                <div class=\\\"attribute-value\\\" id=\\\"character-status1\\\">--</div>\\n                            </div>\\n                            <div class=\\\"attribute-item\\\">\\n                                <div class=\\\"attribute-label\\\">状态</div>\\n                                <div class=\\\"attribute-value\\\" id=\\\"character-status2\\\">--</div>\\n                            </div>\\n                            <div class=\\\"attribute-item\\\">\\n                                <div class=\\\"attribute-label\\\">着装</div>\\n                                <div class=\\\"attribute-value\\\" id=\\\"character-status3\\\">--</div>\\n                            </div>\\n                            <div class=\\\"attribute-item\\\">\\n                                <div class=\\\"attribute-label\\\">想法</div>\\n                                <div class=\\\"attribute-value\\\" id=\\\"character-status4\\\">--</div>\\n                            </div>\\n                        </div>\\n                    </div>\\n                    \\n                    <!-- 状态数据部分 -->\\n                    <div class=\\\"stats-grid\\\">\\n                        <!-- 基础生理状态组 -->\\n                        <div class=\\\"stats-section\\\">\\n                            <div class=\\\"section-title\\\" id=\\\"physiological-title\\\">基础生理状态</div>\\n                            <div class=\\\"stat-item\\\">\\n                                <div class=\\\"stat-label\\\">\\n                                    <span class=\\\"stat-name\\\" id=\\\"vitality-label\\\">体力值</span>\\n                                    <span class=\\\"stat-value\\\" id=\\\"vitality-value\\\">--/100</span>\\n                                </div>\\n                                <div class=\\\"progress-bar\\\">\\n                                    <div class=\\\"progress-fill\\\" id=\\\"vitality-bar\\\" style=\\\"width: 0%\\\"></div>\\n                                </div>\\n                            </div>\\n                            <div class=\\\"stat-item\\\">\\n                                <div class=\\\"stat-label\\\">\\n                                    <span class=\\\"stat-name\\\" id=\\\"satisfaction-label\\\">饥饿度</span>\\n                                    <span class=\\\"stat-value\\\" id=\\\"satisfaction-value\\\">--/100</span>\\n                                </div>\\n                                <div class=\\\"progress-bar\\\">\\n                                    <div class=\\\"progress-fill\\\" id=\\\"satisfaction-bar\\\" style=\\\"width: 0%\\\"></div>\\n                                </div>\\n                            </div>\\n                            <div class=\\\"stat-item\\\">\\n                                <div class=\\\"stat-label\\\">\\n                                    <span class=\\\"stat-name\\\" id=\\\"cleanliness-label\\\">清洁度</span>\\n                                    <span class=\\\"stat-value\\\" id=\\\"cleanliness-value\\\">--/100</span>\\n                                </div>\\n                                <div class=\\\"progress-bar\\\">\\n                                    <div class=\\\"progress-fill\\\" id=\\\"cleanliness-bar\\\" style=\\\"width: 0%\\\"></div>\\n                                </div>\\n                            </div>\\n                            <div class=\\\"stat-item special\\\">\\n                                <div class=\\\"stat-label\\\">\\n                                    <span class=\\\"stat-name\\\" id=\\\"special-effect-label\\\">特殊状态</span>\\n                                    <span class=\\\"stat-value\\\" id=\\\"special-effect\\\">--</span>\\n                                </div>\\n                            </div>\\n                        </div>\\n                        \\n                        <!-- 核心心理状态组 -->\\n                        <div class=\\\"stats-section\\\">\\n                            <div class=\\\"section-title\\\" id=\\\"psychological-title\\\">核心心理状态</div>\\n                            <div class=\\\"radar-chart\\\">\\n                                <canvas id=\\\"psychological-radar\\\"></canvas>\\n                            </div>\\n                            <div class=\\\"stat-values\\\">\\n                                <div class=\\\"stat-value-item\\\">\\n                                    <span class=\\\"stat-name\\\" id=\\\"stability-label\\\">SAN值</span>\\n                                    <span class=\\\"stat-number\\\" id=\\\"stability-value\\\">--/100</span>\\n                                </div>\\n                                <div class=\\\"stat-value-item\\\">\\n                                    <span class=\\\"stat-name\\\" id=\\\"care-label\\\">羞耻心</span>\\n                                    <span class=\\\"stat-number\\\" id=\\\"care-value\\\">--/100</span>\\n                                </div>\\n                                <div class=\\\"stat-value-item\\\">\\n                                    <span class=\\\"stat-name\\\" id=\\\"responsibility-label\\\">罪恶感</span>\\n                                    <span class=\\\"stat-number\\\" id=\\\"responsibility-value\\\">--/100</span>\\n                                </div>\\n                                <div class=\\\"stat-value-item\\\">\\n                                    <span class=\\\"stat-name\\\" id=\\\"alertness-label\\\">恐惧感</span>\\n                                    <span class=\\\"stat-number\\\" id=\\\"alertness-value\\\">--/100</span>\\n                                </div>\\n                                <div class=\\\"stat-value-item\\\">\\n                                    <span class=\\\"stat-name\\\" id=\\\"cooperation-label\\\">屈服度</span>\\n                                    <span class=\\\"stat-number\\\" id=\\\"cooperation-value\\\">--/100</span>\\n                                </div>\\n                            </div>\\n                        </div>\\n                        \\n                        <!-- 调教进展指标组 -->\\n                        <div class=\\\"stats-section\\\">\\n                            <div class=\\\"section-title\\\" id=\\\"progress-title\\\">调教进展指标</div>\\n                            <div class=\\\"stat-item\\\">\\n                                <div class=\\\"stat-label\\\">\\n                                    <span class=\\\"stat-name\\\" id=\\\"status-points-label\\\">堕落值</span>\\n                                    <span class=\\\"stat-value\\\" id=\\\"status-points-value\\\">--/100</span>\\n                                </div>\\n                                <div class=\\\"progress-bar\\\">\\n                                    <div class=\\\"progress-fill\\\" id=\\\"status-points-bar\\\" style=\\\"width: 0%\\\"></div>\\n                                </div>\\n                            </div>\\n                            <div class=\\\"stat-item\\\">\\n                                <div class=\\\"stat-label\\\">\\n                                    <span class=\\\"stat-name\\\" id=\\\"excitement-label\\\">淫欲度</span>\\n                                    <span class=\\\"stat-value\\\" id=\\\"excitement-value\\\">--/100</span>\\n                                </div>\\n                                <div class=\\\"progress-bar\\\">\\n                                    <div class=\\\"progress-fill\\\" id=\\\"excitement-bar\\\" style=\\\"width: 0%\\\"></div>\\n                                </div>\\n                            </div>\\n                            <div class=\\\"stat-item\\\">\\n                                <div class=\\\"stat-label\\\">\\n                                    <span class=\\\"stat-name\\\" id=\\\"principle-label\\\">贞操观念</span>\\n                                    <span class=\\\"stat-value\\\" id=\\\"principle-value\\\">--/100</span>\\n                                </div>\\n                                <div class=\\\"progress-bar\\\">\\n                                    <div class=\\\"progress-fill\\\" id=\\\"principle-bar\\\" style=\\\"width: 0%\\\"></div>\\n                                </div>\\n                            </div>\\n                            <div class=\\\"stat-item\\\">\\n                                <div class=\\\"stat-label\\\">\\n                                    <span class=\\\"stat-name\\\" id=\\\"autonomy-label\\\">抗拒度</span>\\n                                    <span class=\\\"stat-value\\\" id=\\\"autonomy-value\\\">--/100</span>\\n                                </div>\\n                                <div class=\\\"progress-bar\\\">\\n                                    <div class=\\\"progress-fill\\\" id=\\\"autonomy-bar\\\" style=\\\"width: 0%\\\"></div>\\n                                </div>\\n                            </div>\\n                        </div>\\n                        \\n                        <!-- 行为记录与经验组 -->\\n                        <div class=\\\"stats-section\\\">\\n                            <div class=\\\"section-title\\\" id=\\\"behavior-title\\\">行为记录与经验</div>\\n                            <div class=\\\"numeric-stats\\\">\\n                                <div class=\\\"numeric-stat\\\">\\n                                    <div class=\\\"stat-label\\\" id=\\\"total-interactions-label\\\">性行为总数</div>\\n                                    <div class=\\\"stat-number\\\" id=\\\"total-interactions\\\">--</div>\\n                                </div>\\n                                <div class=\\\"numeric-stat\\\">\\n                                    <div class=\\\"stat-label\\\" id=\\\"interaction-a-label\\\">口交</div>\\n                                    <div class=\\\"stat-number\\\" id=\\\"interaction-a\\\">--</div>\\n                                </div>\\n                                <div class=\\\"numeric-stat\\\">\\n                                    <div class=\\\"stat-label\\\" id=\\\"interaction-b-label\\\">肛交</div>\\n                                    <div class=\\\"stat-number\\\" id=\\\"interaction-b\\\">--</div>\\n                                </div>\\n                                <div class=\\\"numeric-stat\\\">\\n                                    <div class=\\\"stat-label\\\" id=\\\"interaction-c-label\\\">阴道性交</div>\\n                                    <div class=\\\"stat-number\\\" id=\\\"interaction-c\\\">--</div>\\n                                </div>\\n                                <div class=\\\"numeric-stat\\\">\\n                                    <div class=\\\"stat-label\\\" id=\\\"personal-interactions-label\\\">自慰</div>\\n                                    <div class=\\\"stat-number\\\" id=\\\"personal-interactions\\\">--</div>\\n                                </div>\\n                                <div class=\\\"numeric-stat\\\">\\n                                    <div class=\\\"stat-label\\\" id=\\\"group-interactions-label\\\">群交</div>\\n                                    <div class=\\\"stat-number\\\" id=\\\"group-interactions\\\">--</div>\\n                                </div>\\n                                <div class=\\\"numeric-stat\\\">\\n                                    <div class=\\\"stat-label\\\" id=\\\"highlight-moments-label\\\">高潮</div>\\n                                    <div class=\\\"stat-number\\\" id=\\\"highlight-moments\\\">--</div>\\n                                </div>\\n                            </div>\\n                            <div class=\\\"text-stat\\\">\\n                                <div class=\\\"text-label\\\" id=\\\"special-status-label\\\">受孕状态</div>\\n                                <div class=\\\"text-value\\\" id=\\\"special-status\\\">--</div>\\n                            </div>\\n                            <div class=\\\"text-stat\\\">\\n                                <div class=\\\"text-label\\\" id=\\\"event-record-label\\\">破处记录</div>\\n                                <div class=\\\"text-value\\\" id=\\\"event-record\\\">--</div>\\n                            </div>\\n                            <div class=\\\"text-stat\\\">\\n                                <div class=\\\"text-label\\\" id=\\\"memory-record-label\\\">重要备注</div>\\n                                <div class=\\\"text-value\\\" id=\\\"memory-record\\\">--</div>\\n                            </div>\\n                        </div>\\n                    </div>\\n                </div>\\n            </div>\\n        </div>\\n        \\n        <!-- 选择框容器 - 放在主内容容器外面，确保它位于状态栏下方 -->\\n        <div class=\\\"choice-container\\\" id=\\\"choice-container\\\" style=\\\"display: none;\\\">\\n            <div class=\\\"choice-title\\\">请做出选择</div>\\n            <div class=\\\"choice-wrapper\\\" id=\\\"choice-wrapper\\\">\\n                <!-- 选项将在这里动态生成 -->\\n            </div>\\n        </div>\\n    </div>\\n\\n    <script>\\n        document.addEventListener('DOMContentLoaded', function() {\\n            const errorMessage = document.getElementById('error-message');\\n            const loadingIndicator = document.getElementById('loading-indicator');\\n            const mainContent = document.getElementById('main-content');\\n            const perspectiveTabs = document.getElementById('perspective-tabs');\\n            const perspectivesContent = document.getElementById('perspectives-content');\\n            const infoBar = document.getElementById('info-bar');\\n            const choiceContainer = document.getElementById('choice-container');\\n            const choiceWrapper = document.getElementById('choice-wrapper');\\n            \\n            // 主页面切换\\n            const mainTabs = document.querySelectorAll('.main-tab');\\n            const mainPages = document.querySelectorAll('.main-page');\\n            \\n            mainTabs.forEach(tab => {\\n                tab.addEventListener('click', function() {\\n                    // 移除所有标签和页面的active类\\n                    mainTabs.forEach(t => t.classList.remove('active'));\\n                    mainPages.forEach(p => p.classList.remove('active'));\\n                    \\n                    // 添加active类到当前标签和对应页面\\n                    this.classList.add('active');\\n                    const tabId = this.getAttribute('data-tab');\\n                    document.getElementById(`${tabId}-page`).classList.add('active');\\n                });\\n            });\\n            \\n            // 存储解析后的数据\\n            let parsedData = {\\n                date: '',\\n                time: '',\\n                weekday: '',\\n                temperature: '',\\n                location: '',\\n                mainContent: '',\\n                characters: [],\\n                currentCharacterIndex: 0,\\n                choiceOptions: [] // 存储选择框选项\\n            };\\n            \\n            let currentMessageId = null;\\n            let initialCheckTimeout = null;\\n            let psychologicalRadarChart = null;\\n            \\n            // 获取当前iframe的名称，用于确定所在消息框\\n            function getIframeName() {\\n                try {\\n                    if (typeof window.getIframeName === 'function') {\\n                        return window.getIframeName();\\n                    } else {\\n                        return window.name || '';\\n                    }\\n                } catch (error) {\\n                    console.error(\\\"获取iframe名称出错:\\\", error);\\n                    return '';\\n                }\\n            }\\n            \\n            // 从iframe名称中提取消息ID\\n            function getMessageIdFromIframeName(iframeName) {\\n                try {\\n                    if (iframeName.startsWith('message-iframe-')) {\\n                        const parts = iframeName.split('-');\\n                        if (parts.length >= 3) {\\n                            return parseInt(parts[2]);\\n                        }\\n                    }\\n                    \\n                    if (typeof window.getCurrentMessageId === 'function') {\\n                        return window.getCurrentMessageId();\\n                    }\\n                    \\n                    return null;\\n                } catch (error) {\\n                    console.error(\\\"从iframe名称提取消息ID出错:\\\", error);\\n                    return null;\\n                }\\n            }\\n            \\n            // 获取当前消息内容\\n            async function getCurrentMessageContent() {\\n                try {\\n                    const iframeName = getIframeName();\\n                    currentMessageId = getMessageIdFromIframeName(iframeName);\\n                    \\n                    if (currentMessageId === null) {\\n                        throw new Error('无法确定当前消息ID');\\n                    }\\n                    \\n                    if (typeof window.getChatMessages === 'function') {\\n                        const messages = await window.getChatMessages(currentMessageId.toString());\\n                        if (messages && messages.length > 0) {\\n                            return messages[0].message || '';\\n                        }\\n                    } \\n                    else if (typeof SillyTavern !== 'undefined' && SillyTavern.getContext) {\\n                        const chat = SillyTavern.getContext().chat;\\n                        if (chat && chat.length > currentMessageId) {\\n                            return chat[currentMessageId].mes || '';\\n                        }\\n                    } \\n                    else {\\n                        const messageElement = document.querySelector(`div.mes[mesid=\\\"${currentMessageId}\\\"]`, window.parent.document);\\n                        if (messageElement) {\\n                            const textElement = messageElement.querySelector('div.mes_text');\\n                            if (textElement) {\\n                                return textElement.textContent || '';\\n                            }\\n                        }\\n                    }\\n                    \\n                    throw new Error('无法获取当前消息内容');\\n                } catch (error) {\\n                    console.error(\\\"获取当前消息内容出错:\\\", error);\\n                    return '';\\n                }\\n            }\\n            \\n            // 解析时间地点天气信息\\n            function parseInfoData(content) {\\n                // 日期\\n                const dateMatch = content.match(/\\\\[DT:([\\\\s\\\\S]*?)\\\\]/);\\n                if (dateMatch && dateMatch[1]) {\\n                    parsedData.date = dateMatch[1].trim();\\n                }\\n                \\n                // 时间\\n                const timeMatch = content.match(/\\\\[TM:([\\\\s\\\\S]*?)\\\\]/);\\n                if (timeMatch && timeMatch[1]) {\\n                    parsedData.time = timeMatch[1].trim();\\n                }\\n                \\n                // 星期\\n                const weekdayMatch = content.match(/\\\\[WK:([\\\\s\\\\S]*?)\\\\]/);\\n                if (weekdayMatch && weekdayMatch[1]) {\\n                    parsedData.weekday = weekdayMatch[1].trim();\\n                }\\n                \\n                // 温度\\n                const tempMatch = content.match(/\\\\[TMP:([\\\\s\\\\S]*?)\\\\]/);\\n                if (tempMatch && tempMatch[1]) {\\n                    parsedData.temperature = tempMatch[1].trim();\\n                }\\n                \\n                // 地点\\n                const posMatch = content.match(/\\\\[POS:([\\\\s\\\\S]*?)\\\\]/);\\n                if (posMatch && posMatch[1]) {\\n                    parsedData.location = posMatch[1].trim();\\n                }\\n                \\n                // 更新信息栏\\n                document.getElementById('date-info').textContent = `日期: ${parsedData.date || '--'}`;\\n                document.getElementById('time-info').textContent = `时间: ${parsedData.time || '--'}`;\\n                document.getElementById('weekday-info').textContent = `星期: ${parsedData.weekday || '--'}`;\\n                document.getElementById('temp-info').textContent = `温度: ${parsedData.temperature || '--'}`;\\n                document.getElementById('location-info').textContent = `地点: ${parsedData.location || '--'}`;\\n            }\\n            \\n            // 解析状态数据\\n            function parseStatusData(content) {\\n                // 查找所有状态数据块\\n                const allStatusBlocks = content.match(/<StatusBlocks>([\\\\s\\\\S]*?)<\\\\/StatusBlocks>/g);\\n                if (!allStatusBlocks || allStatusBlocks.length === 0) return;\\n                \\n                // 重置角色数组\\n                parsedData.characters = [];\\n                parsedData.currentCharacterIndex = 0;\\n                \\n                // 处理每个状态数据块\\n                for (let block of allStatusBlocks) {\\n                    const statusMatch = block.match(/<StatusBlocks>([\\\\s\\\\S]*?)<\\\\/StatusBlocks>/);\\n                    if (!statusMatch || !statusMatch[1]) continue;\\n                    \\n                    const statusContent = statusMatch[1].trim();\\n                    \\n                    // 使用非贪婪模式匹配所有状态数据，即使其中包含换行符或特殊字符\\n                    const statusParts = [];\\n                    let bracketLevel = 0;\\n                    let currentPart = '';\\n                    \\n                    for (let i = 0; i < statusContent.length; i++) {\\n                        const char = statusContent[i];\\n                        \\n                        if (char === '[' && (i === 0 || statusContent[i-1] !== '\\\\\\\\')) {\\n                            if (bracketLevel === 0) {\\n                                currentPart = '[';\\n                            } else {\\n                                currentPart += char;\\n                            }\\n                            bracketLevel++;\\n                        } \\n                        else if (char === ']' && (i === 0 || statusContent[i-1] !== '\\\\\\\\')) {\\n                            bracketLevel--;\\n                            if (bracketLevel === 0) {\\n                                currentPart += ']';\\n                                statusParts.push(currentPart);\\n                                currentPart = '';\\n                            } else {\\n                                currentPart += char;\\n                            }\\n                        } \\n                        else {\\n                            if (bracketLevel > 0) {\\n                                currentPart += char;\\n                            }\\n                        }\\n                    }\\n                    \\n                    if (!statusParts || statusParts.length < 20) continue;\\n                    \\n                    // 提取中括号内的内容（保留所有格式，包括换行符）\\n                    const cleanData = statusParts.map(part => {\\n                        // 移除最外层的中括号，保留内部的一切字符\\n                        return part.substring(1, part.length - 1);\\n                    });\\n                    \\n                    // 创建角色数据对象\\n                    const characterData = {\\n                        characterName: cleanData[0] || '',\\n                        avatarUrl: cleanData[1] || '',\\n                        physiological: {\\n                            vitality: 0,\\n                            vitalityText: '',\\n                            satisfaction: 0,\\n                            satisfactionText: '',\\n                            cleanliness: 0,\\n                            cleanlinessText: '',\\n                            specialEffect: ''\\n                        },\\n                        psychological: {\\n                            stability: 0,\\n                            stabilityText: '',\\n                            care: 0,\\n                            careText: '',\\n                            responsibility: 0,\\n                            responsibilityText: '',\\n                            alertness: 0,\\n                            alertnessText: '',\\n                            cooperation: 0,\\n                            cooperationText: ''\\n                        },\\n                        progress: {\\n                            statusPoints: 0,\\n                            statusPointsText: '',\\n                            excitement: 0,\\n                            excitementText: '',\\n                            principle: 0,\\n                            principleText: '',\\n                            autonomy: 0,\\n                            autonomyText: ''\\n                        },\\n                        behavior: {\\n                            totalInteractions: 0,\\n                            interactionA: 0,\\n                            interactionB: 0,\\n                            interactionC: 0,\\n                            personalInteractions: 0,\\n                            groupInteractions: 0,\\n                            highlightMoments: 0,\\n                            specialStatus: '',\\n                            eventRecord: '',\\n                            memoryRecord: ''\\n                        },\\n                        characterStatus: {\\n                            status1: '',\\n                            status2: '',\\n                            status3: '',\\n                            status4: ''\\n                        }\\n                    };\\n                    \\n                    // 基础生理状态组\\n                    const physiologicalValues = [\\n                        cleanData[2], // 体力值\\n                        cleanData[3], // 饥饿度\\n                        cleanData[4], // 清洁度\\n                        cleanData[5]  // 药物影响\\n                    ];\\n                    \\n                    // 核心心理状态组\\n                    const psychologicalValues = [\\n                        cleanData[6], // SAN值\\n                        cleanData[7], // 羞耻心\\n                        cleanData[8], // 罪恶感\\n                        cleanData[9], // 恐惧感\\n                        cleanData[10] // 屈服度\\n                    ];\\n                    \\n                    // 调教进展指标组\\n                    const progressValues = [\\n                        cleanData[11], // 堕落值\\n                        cleanData[12], // 淫欲度\\n                        cleanData[13], // 贞操观念\\n                        cleanData[14]  // 抗拒度\\n                    ];\\n                    \\n                    // 行为记录与经验组\\n                    const behaviorValues = [\\n                        cleanData[15], // 性行为总数\\n                        cleanData[16], // 口交\\n                        cleanData[17], // 肛交\\n                        cleanData[18], // 阴道性交\\n                        cleanData[19], // 自慰\\n                        cleanData[20], // 群交\\n                        cleanData[21], // 高潮\\n                        cleanData[22], // 受孕状态\\n                        cleanData[23], // 事件记录\\n                        cleanData[24]  // 回忆记录\\n                    ];\\n                    \\n                    // 角色基础属性（检查是否有额外的ST标签）\\n                    const characterStatusValues = [];\\n                    \\n                    // 查找所有ST标签\\n                    for (let i = 25; i < cleanData.length; i++) {\\n                        const statusText = cleanData[i] || '';\\n                        if (statusText.startsWith('ST:')) {\\n                            characterStatusValues.push(statusText.substring(3));\\n                        }\\n                    }\\n                    \\n                    // 处理基础生理状态\\n                    const parsePercentage = (str) => {\\n                        const parts = str.split('/');\\n                        if (parts.length === 2) {\\n                            const current = parseInt(parts[0]);\\n                            const max = parseInt(parts[1]);\\n                            if (!isNaN(current) && !isNaN(max) && max !== 0) {\\n                                return {\\n                                    current: current,\\n                                    max: max,\\n                                    percentage: (current / max) * 100\\n                                };\\n                            }\\n                        }\\n                        return { current: 0, max: 100, percentage: 0 };\\n                    };\\n                    \\n                    // 解析基础生理状态\\n                    const vitalityData = parsePercentage(physiologicalValues[0]);\\n                    const satisfactionData = parsePercentage(physiologicalValues[1]);\\n                    const cleanlinessData = parsePercentage(physiologicalValues[2]);\\n                    \\n                    characterData.physiological = {\\n                        vitality: vitalityData.percentage,\\n                        vitalityText: physiologicalValues[0],\\n                        satisfaction: satisfactionData.percentage,\\n                        satisfactionText: physiologicalValues[1],\\n                        cleanliness: cleanlinessData.percentage,\\n                        cleanlinessText: physiologicalValues[2],\\n                        specialEffect: physiologicalValues[3]\\n                    };\\n                    \\n                    // 解析核心心理状态\\n                    const stabilityData = parsePercentage(psychologicalValues[0]);\\n                    const careData = parsePercentage(psychologicalValues[1]);\\n                    const responsibilityData = parsePercentage(psychologicalValues[2]);\\n                    const alertnessData = parsePercentage(psychologicalValues[3]);\\n                    const cooperationData = parsePercentage(psychologicalValues[4]);\\n                    \\n                    characterData.psychological = {\\n                        stability: stabilityData.percentage,\\n                        stabilityText: psychologicalValues[0],\\n                        care: careData.percentage,\\n                        careText: psychologicalValues[1],\\n                        responsibility: responsibilityData.percentage,\\n                        responsibilityText: psychologicalValues[2],\\n                        alertness: alertnessData.percentage,\\n                        alertnessText: psychologicalValues[3],\\n                        cooperation: cooperationData.percentage,\\n                        cooperationText: psychologicalValues[4]\\n                    };\\n                    \\n                    // 解析调教进展指标\\n                    const statusPointsData = parsePercentage(progressValues[0]);\\n                    const excitementData = parsePercentage(progressValues[1]);\\n                    const principleData = parsePercentage(progressValues[2]);\\n                    const autonomyData = parsePercentage(progressValues[3]);\\n                    \\n                    characterData.progress = {\\n                        statusPoints: statusPointsData.percentage,\\n                        statusPointsText: progressValues[0],\\n                        excitement: excitementData.percentage,\\n                        excitementText: progressValues[1],\\n                        principle: principleData.percentage,\\n                        principleText: progressValues[2],\\n                        autonomy: autonomyData.percentage,\\n                        autonomyText: progressValues[3]\\n                    };\\n                    \\n                    // 解析行为记录与经验\\n                    characterData.behavior = {\\n                        totalInteractions: behaviorValues[0],\\n                        interactionA: behaviorValues[1],\\n                        interactionB: behaviorValues[2],\\n                        interactionC: behaviorValues[3],\\n                        personalInteractions: behaviorValues[4],\\n                        groupInteractions: behaviorValues[5],\\n                        highlightMoments: behaviorValues[6],\\n                        specialStatus: behaviorValues[7],\\n                        eventRecord: behaviorValues[8],\\n                        memoryRecord: behaviorValues[9]\\n                    };\\n                    \\n                    // 保存角色基础属性\\n                    characterData.characterStatus = {\\n                        status1: characterStatusValues[0] || '',\\n                        status2: characterStatusValues[1] || '',\\n                        status3: characterStatusValues[2] || '',\\n                        status4: characterStatusValues[3] || ''\\n                    };\\n                    \\n                    // 将角色添加到数组\\n                    parsedData.characters.push(characterData);\\n                }\\n                \\n                // 更新当前角色状态页面\\n                updateCharacterCounter();\\n                updateStatusPage();\\n            }\\n            \\n            // 解析选择框数据\\n            function parseChoiceData(content) {\\n                // 重置选择框数据\\n                parsedData.choiceOptions = [];\\n                \\n                // 查找选择框数据块\\n                const checkboxMatch = content.match(/<Checkbox>([\\\\s\\\\S]*?)<\\\\/Checkbox>/);\\n                if (!checkboxMatch || !checkboxMatch[1]) {\\n                    // 没有找到选择框数据，隐藏选择框\\n                    choiceContainer.style.display = 'none';\\n                    return;\\n                }\\n                \\n                const choiceContent = checkboxMatch[1].trim();\\n                \\n                // 提取选项数据\\n                const optionParts = [];\\n                let bracketLevel = 0;\\n                let currentPart = '';\\n                \\n                for (let i = 0; i < choiceContent.length; i++) {\\n                    const char = choiceContent[i];\\n                    \\n                    if (char === '[' && (i === 0 || choiceContent[i-1] !== '\\\\\\\\')) {\\n                        if (bracketLevel === 0) {\\n                            currentPart = '[';\\n                        } else {\\n                            currentPart += char;\\n                        }\\n                        bracketLevel++;\\n                    } \\n                    else if (char === ']' && (i === 0 || choiceContent[i-1] !== '\\\\\\\\')) {\\n                        bracketLevel--;\\n                        if (bracketLevel === 0) {\\n                            currentPart += ']';\\n                            optionParts.push(currentPart);\\n                            currentPart = '';\\n                        } else {\\n                            currentPart += char;\\n                        }\\n                    } \\n                    else {\\n                        if (bracketLevel > 0) {\\n                            currentPart += char;\\n                        }\\n                    }\\n                }\\n                \\n                // 处理选项\\n                if (optionParts && optionParts.length > 0) {\\n                    // 提取中括号内的内容\\n                    parsedData.choiceOptions = optionParts.map(part => {\\n                        // 移除最外层的中括号\\n                        return part.substring(1, part.length - 1);\\n                    });\\n                    \\n                    // 更新选择框\\n                    updateChoiceBox();\\n                } else {\\n                    // 没有选项，隐藏选择框\\n                    choiceContainer.style.display = 'none';\\n                }\\n            }\\n            \\n            // 更新选择框显示\\n            function updateChoiceBox() {\\n                // 清空当前选项\\n                choiceWrapper.innerHTML = '';\\n                \\n                // 有选项时显示选择框，否则隐藏\\n                if (parsedData.choiceOptions.length > 0) {\\n                    // 创建选项按钮\\n                    parsedData.choiceOptions.forEach(option => {\\n                        const optionElement = document.createElement('div');\\n                        optionElement.className = 'choice-option';\\n                        optionElement.textContent = option;\\n                        optionElement.addEventListener('click', function() {\\n                            handleChoiceClick(option);\\n                        });\\n                        choiceWrapper.appendChild(optionElement);\\n                    });\\n                    \\n                    // 显示选择框\\n                    choiceContainer.style.display = 'block';\\n                } else {\\n                    // 隐藏选择框\\n                    choiceContainer.style.display = 'none';\\n                }\\n            }\\n            \\n            // 处理选项点击事件\\n            function handleChoiceClick(optionText) {\\n                try {\\n                    // 格式化发送的文本\\n                    const requestText = `<request:{{user}}选择了[${optionText}]>`;\\n                    \\n                    // 发送选项到酒馆并触发回复\\n                    if (typeof window.triggerSlash === 'function') {\\n                        window.triggerSlash(`/send ${requestText} || /trigger`);\\n                    } else if (window.parent && typeof window.parent.triggerSlash === 'function') {\\n                        window.parent.triggerSlash(`/send ${requestText} || /trigger`);\\n                    } else {\\n                        console.error('无法找到triggerSlash函数');\\n                        \\n                        // 尝试其他方法发送消息\\n                        if (window.parent && window.parent.document) {\\n                            const textareaElement = window.parent.document.querySelector('#send_textarea');\\n                            const sendButton = window.parent.document.querySelector('#send_but');\\n                            \\n                            if (textareaElement && sendButton) {\\n                                textareaElement.value = requestText;\\n                                sendButton.click();\\n                            } else {\\n                                console.error('无法找到发送消息的元素');\\n                            }\\n                        }\\n                    }\\n                } catch (error) {\\n                    console.error('发送选项时出错:', error);\\n                }\\n            }\\n            \\n            // 更新角色状态页面\\n            function updateStatusPage() {\\n                // 检查是否有角色数据\\n                if (parsedData.characters.length === 0) {\\n                    return;\\n                }\\n                \\n                // 获取当前角色数据\\n                const currentCharacter = parsedData.characters[parsedData.currentCharacterIndex];\\n                \\n                // 更新角色信息\\n                document.getElementById('character-name').textContent = currentCharacter.characterName || '--';\\n                \\n                // 更新头像\\n                const avatarImg = document.getElementById('character-avatar');\\n                if (currentCharacter.avatarUrl && currentCharacter.avatarUrl !== '--') {\\n                    avatarImg.src = currentCharacter.avatarUrl;\\n                } else {\\n                    avatarImg.src = \\\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiB2aWV3Qm94PSIwIDAgMjAwIDIwMCI+PHJlY3Qgd2lkdGg9IjIwMCIgaGVpZ2h0PSIyMDAiIGZpbGw9IiMyYTJhMmEiLz48dGV4dCB4PSI1MCUiIHk9IjUwJSIgZm9udC1zaXplPSIyMCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgYWxpZ25tZW50LWJhc2VsaW5lPSJtaWRkbGUiIGZpbGw9IiNmZmZmZmYiPuWbvueJh+WKoOi9veWksei0pTwvdGV4dD48L3N2Zz4=\\\";\\n                }\\n                \\n                // 更新角色基础属性\\n                document.getElementById('character-status1').textContent = currentCharacter.characterStatus.status1 || '--';\\n                document.getElementById('character-status2').textContent = currentCharacter.characterStatus.status2 || '--';\\n                document.getElementById('character-status3').textContent = currentCharacter.characterStatus.status3 || '--';\\n                document.getElementById('character-status4').textContent = currentCharacter.characterStatus.status4 || '--';\\n                \\n                // 更新基础生理状态组\\n                document.getElementById('vitality-value').textContent = currentCharacter.physiological.vitalityText || '--/100';\\n                document.getElementById('vitality-bar').style.width = `${currentCharacter.physiological.vitality}%`;\\n                \\n                document.getElementById('satisfaction-value').textContent = currentCharacter.physiological.satisfactionText || '--/100';\\n                document.getElementById('satisfaction-bar').style.width = `${currentCharacter.physiological.satisfaction}%`;\\n                \\n                document.getElementById('cleanliness-value').textContent = currentCharacter.physiological.cleanlinessText || '--/100';\\n                document.getElementById('cleanliness-bar').style.width = `${currentCharacter.physiological.cleanliness}%`;\\n                \\n                document.getElementById('special-effect').textContent = currentCharacter.physiological.specialEffect || '--';\\n                \\n                // 更新心理状态雷达图\\n                updatePsychologicalRadar();\\n                \\n                // 更新核心心理状态值显示\\n                document.getElementById('stability-value').textContent = currentCharacter.psychological.stabilityText || '--/100';\\n                document.getElementById('care-value').textContent = currentCharacter.psychological.careText || '--/100';\\n                document.getElementById('responsibility-value').textContent = currentCharacter.psychological.responsibilityText || '--/100';\\n                document.getElementById('alertness-value').textContent = currentCharacter.psychological.alertnessText || '--/100';\\n                document.getElementById('cooperation-value').textContent = currentCharacter.psychological.cooperationText || '--/100';\\n                \\n                // 更新调教进展指标组\\n                document.getElementById('status-points-value').textContent = currentCharacter.progress.statusPointsText || '--/100';\\n                document.getElementById('status-points-bar').style.width = `${currentCharacter.progress.statusPoints}%`;\\n                \\n                document.getElementById('excitement-value').textContent = currentCharacter.progress.excitementText || '--/100';\\n                document.getElementById('excitement-bar').style.width = `${currentCharacter.progress.excitement}%`;\\n                \\n                document.getElementById('principle-value').textContent = currentCharacter.progress.principleText || '--/100';\\n                document.getElementById('principle-bar').style.width = `${currentCharacter.progress.principle}%`;\\n                \\n                document.getElementById('autonomy-value').textContent = currentCharacter.progress.autonomyText || '--/100';\\n                document.getElementById('autonomy-bar').style.width = `${currentCharacter.progress.autonomy}%`;\\n                \\n                // 更新行为记录与经验组\\n                document.getElementById('total-interactions').textContent = currentCharacter.behavior.totalInteractions || '--';\\n                document.getElementById('interaction-a').textContent = currentCharacter.behavior.interactionA || '--';\\n                document.getElementById('interaction-b').textContent = currentCharacter.behavior.interactionB || '--';\\n                document.getElementById('interaction-c').textContent = currentCharacter.behavior.interactionC || '--';\\n                document.getElementById('personal-interactions').textContent = currentCharacter.behavior.personalInteractions || '--';\\n                document.getElementById('group-interactions').textContent = currentCharacter.behavior.groupInteractions || '--';\\n                document.getElementById('highlight-moments').textContent = currentCharacter.behavior.highlightMoments || '--';\\n                \\n                document.getElementById('special-status').textContent = currentCharacter.behavior.specialStatus || '--';\\n                document.getElementById('event-record').textContent = currentCharacter.behavior.eventRecord || '--';\\n                document.getElementById('memory-record').textContent = currentCharacter.behavior.memoryRecord || '--';\\n                \\n                // 确保应用当前自定义标签\\n                updateAllLabels();\\n            }\\n            \\n            // 更新心理状态雷达图\\n            function updatePsychologicalRadar() {\\n                const ctx = document.getElementById('psychological-radar').getContext('2d');\\n                \\n                // 检查是否有角色数据\\n                if (parsedData.characters.length === 0) {\\n                    return;\\n                }\\n                \\n                // 获取当前角色数据\\n                const currentCharacter = parsedData.characters[parsedData.currentCharacterIndex];\\n                \\n                // 如果已有图表，先销毁\\n                if (psychologicalRadarChart) {\\n                    psychologicalRadarChart.destroy();\\n                }\\n                \\n                // 创建新图表\\n                psychologicalRadarChart = new Chart(ctx, {\\n                    type: 'radar',\\n                    data: {\\n                        labels: ['SAN值', '羞耻心', '罪恶感', '恐惧感', '屈服度'],\\n                        datasets: [{\\n                            label: '心理状态',\\n                            data: [\\n                                currentCharacter.psychological.stability,\\n                                currentCharacter.psychological.care,\\n                                currentCharacter.psychological.responsibility,\\n                                currentCharacter.psychological.alertness,\\n                                currentCharacter.psychological.cooperation\\n                            ],\\n                            backgroundColor: 'rgba(60, 60, 60, 0.4)',\\n                            borderColor: 'rgba(170, 170, 170, 0.8)',\\n                            borderWidth: 2,\\n                            pointBackgroundColor: '#707070',\\n                            pointBorderColor: '#f0f0f0',\\n                            pointHoverBackgroundColor: '#fff',\\n                            pointHoverBorderColor: 'rgba(200, 200, 200, 1)'\\n                        }]\\n                    },\\n                    options: {\\n                        elements: {\\n                            line: {\\n                                borderWidth: 3\\n                            }\\n                        },\\n                        scales: {\\n                            r: {\\n                                angleLines: {\\n                                    color: 'rgba(180, 180, 180, 0.2)'\\n                                },\\n                                grid: {\\n                                    color: 'rgba(180, 180, 180, 0.2)'\\n                                },\\n                                pointLabels: {\\n                                    color: '#c0c0c0',\\n                                    font: {\\n                                        size: 12,\\n                                        family: \\\"'SF Pro Text', 'Segoe UI', sans-serif\\\",\\n                                        weight: '500'\\n                                    }\\n                                },\\n                                ticks: {\\n                                    display: false, \\n                                    backdropColor: 'transparent',\\n                                    color: '#c0c0c0'\\n                                },\\n                                suggestedMin: 0,\\n                                suggestedMax: 100\\n                            }\\n                        },\\n                        plugins: {\\n                            legend: {\\n                                display: false\\n                            }\\n                        }\\n                    }\\n                });\\n            }\\n            \\n            // 更新角色计数器\\n            function updateCharacterCounter() {\\n                const totalCharacters = parsedData.characters.length;\\n                const currentIndex = parsedData.currentCharacterIndex + 1;\\n                document.getElementById('character-counter').textContent = `${currentIndex}/${totalCharacters}`;\\n                \\n                // 更新按钮状态\\n                document.getElementById('prev-character').classList.toggle('disabled', totalCharacters <= 1 || currentIndex === 1);\\n                document.getElementById('next-character').classList.toggle('disabled', totalCharacters <= 1 || currentIndex === totalCharacters);\\n            }\\n            \\n            // 下一个角色\\n            function nextCharacter() {\\n                const totalCharacters = parsedData.characters.length;\\n                if (totalCharacters <= 1 || parsedData.currentCharacterIndex >= totalCharacters - 1) {\\n                    return; // 已经是最后一个角色\\n                }\\n                \\n                parsedData.currentCharacterIndex++;\\n                updateCharacterCounter();\\n                updateStatusPage();\\n            }\\n            \\n            // 上一个角色\\n            function prevCharacter() {\\n                if (parsedData.characters.length <= 1 || parsedData.currentCharacterIndex <= 0) {\\n                    return; // 已经是第一个角色\\n                }\\n                \\n                parsedData.currentCharacterIndex--;\\n                updateCharacterCounter();\\n                updateStatusPage();\\n            }\\n            \\n            // 提取主要内容（排除状态数据标签和选择框标签中的内容）\\n            function extractMainContent(content) {\\n                // 创建临时content副本\\n                let mainContent = content;\\n                \\n                // 移除状态数据标签及其内容 - 使用[\\\\s\\\\S]*?匹配多行文本\\n                const statusRegex = /<StatusBlocks>([\\\\s\\\\S]*?)<\\\\/StatusBlocks>/g;\\n                mainContent = mainContent.replace(statusRegex, '');\\n                \\n                // 移除选择框标签及其内容\\n                const checkboxRegex = /<Checkbox>([\\\\s\\\\S]*?)<\\\\/Checkbox>/g;\\n                mainContent = mainContent.replace(checkboxRegex, '');\\n                \\n                // 移除时间地点天气信息 - 使用[\\\\s\\\\S]*?匹配多行文本\\n                mainContent = mainContent.replace(/\\\\[(DT|TM|WK|TMP|POS):([\\\\s\\\\S]*?)\\\\]/g, '');\\n                \\n                // 清理额外的空行但保留基本格式\\n                mainContent = mainContent.replace(/\\\\n{4,}/g, '\\\\n\\\\n\\\\n').trim();\\n                \\n                try {\\n                    // 修复Markdown风格图片标签的正则表达式，避免特殊字符导致语法错误\\n                    mainContent = mainContent.replace(/!\\\\[(.*?)\\\\]\\\\((.*?)\\\\)/g, function(match, alt, src) {\\n                        // 处理源URL中可能包含的特殊字符\\n                        const safeAlt = alt || '图片';\\n                        const safeSrc = src.replace(/\\\"/g, '&quot;'); // 转义引号防止HTML注入\\n                        \\n                        // 使用单引号避免与双引号冲突，添加加载失败的回退图像\\n                        return '<img src=\\\\'' + safeSrc + '\\\\' alt=\\\\'' + safeAlt + '\\\\' onerror=\\\"this.onerror=null;this.src=\\\\'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiB2aWV3Qm94PSIwIDAgMjAwIDIwMCI+PHJlY3Qgd2lkdGg9IjIwMCIgaGVpZ2h0PSIyMDAiIGZpbGw9IiMyYTJhMmEiLz48dGV4dCB4PSI1MCUiIHk9IjUwJSIgZm9udC1zaXplPSIyMCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgYWxpZ25tZW50LWJhc2VsaW5lPSJtaWRkbGUiIGZpbGw9IiNmZmZmZmYiPuWbvueJh+WKoOi9veWksei0pTwvdGV4dD48L3N2Zz4=\\\\'\\\">';\\n                    });\\n                } catch (error) {\\n                    console.error(\\\"处理图片标记时出错:\\\", error);\\n                }\\n                \\n                return mainContent;\\n            }\\n            \\n            // 解析消息功能\\n            async function parseMessage() {\\n                // 重置错误信息\\n                errorMessage.style.display = 'none';\\n                \\n                // 添加超时保护，确保加载指示器不会无限显示\\n                const parseTimeout = setTimeout(() => {\\n                    loadingIndicator.style.display = 'none';\\n                    errorMessage.textContent = '解析超时，请刷新页面重试';\\n                    errorMessage.style.display = 'block';\\n                }, 10000); // 10秒超时\\n                \\n                try {\\n                    // 尝试获取消息内容\\n                    const messageContent = await getCurrentMessageContent();\\n                    \\n                    // 检查是否成功获取消息内容\\n                    if (!messageContent) {\\n                        throw new Error('获取消息内容失败');\\n                    }\\n                    \\n                    // 检查消息中是否包含<content>标签\\n                    if (!messageContent.includes('<content>') || !messageContent.includes('</content>')) {\\n                        // 没有找到内容标签，清空并隐藏\\n                        mainContent.innerHTML = '';\\n                        loadingIndicator.style.display = 'none';\\n                        choiceContainer.style.display = 'none';\\n                        clearTimeout(parseTimeout);\\n                        return;\\n                    }\\n                    \\n                    // 提取<content>标签内的内容\\n                    const contentRegex = /<content>([\\\\s\\\\S]*?)<\\\\/content>/;\\n                    const contentMatch = messageContent.match(contentRegex);\\n                    \\n                    if (!contentMatch || !contentMatch[1]) {\\n                        throw new Error('<content>标签内没有有效内容');\\n                    }\\n                    \\n                    // 获取内容\\n                    const content = contentMatch[1];\\n                    \\n                    // 逐步解析各个部分，任何部分出错不影响整体\\n                    try {\\n                        parseInfoData(content);\\n                    } catch (e) {\\n                        console.error(\\\"解析信息数据出错:\\\", e);\\n                    }\\n                    \\n                    try {\\n                        parseStatusData(content);\\n                    } catch (e) {\\n                        console.error(\\\"解析状态数据出错:\\\", e);\\n                    }\\n                    \\n                    try {\\n                        parseChoiceData(content);\\n                    } catch (e) {\\n                        console.error(\\\"解析选择框数据出错:\\\", e);\\n                    }\\n                    \\n                    // 提取主要文本\\n                    let mainText = '';\\n                    try {\\n                        mainText = extractMainContent(content);\\n                    } catch (e) {\\n                        console.error(\\\"提取主要内容出错:\\\", e);\\n                        mainText = content; // 使用原始内容作为备用\\n                    }\\n                    \\n                    // 隐藏加载指示器并更新内容\\n                    loadingIndicator.style.display = 'none';\\n                    mainContent.innerHTML = mainText;\\n                    \\n                } catch (error) {\\n                    // 发生错误时的处理\\n                    console.error(\\\"解析消息出错:\\\", error);\\n                    errorMessage.textContent = `解析错误: ${error.message}`;\\n                    errorMessage.style.display = 'block';\\n                    loadingIndicator.style.display = 'none';\\n                    choiceContainer.style.display = 'none';\\n                } finally {\\n                    // 确保清除超时计时器\\n                    clearTimeout(parseTimeout);\\n                }\\n            }\\n            \\n            // 设置自动解析\\n            function setupAutoCheck() {\\n                // 立即执行一次解析\\n                parseMessage();\\n                \\n                // 由于初始加载时可能数据还未准备好，设置延迟检测\\n                initialCheckTimeout = setTimeout(() => {\\n                    parseMessage();\\n                }, 1000); // 1秒后再次检测\\n            }\\n            \\n            // 文本自定义功能\\n            const defaultLabels = {\\n                // 基础生理状态\\n                'physiological-title': '基础生理状态',\\n                'vitality': '体力值',\\n                'satisfaction': '饥饿度',\\n                'cleanliness': '清洁度',\\n                'special-effect': '特殊状态',\\n                \\n                // 核心心理状态\\n                'psychological-title': '核心心理状态',\\n                'stability': 'SAN值',\\n                'care': '羞耻心',\\n                'responsibility': '罪恶感',\\n                'alertness': '恐惧感',\\n                'cooperation': '屈服度',\\n                \\n                // 调教进展指标\\n                'progress-title': '调教进展指标',\\n                'status-points': '堕落值',\\n                'excitement': '淫欲度',\\n                'principle': '贞操观念',\\n                'autonomy': '自主能力',\\n                \\n                // 行为记录与经验\\n                'behavior-title': '行为记录与经验',\\n                'total-interactions': '性行为',\\n                'interaction-a': '口交',\\n                'interaction-b': '肛交',\\n                'interaction-c': '阴道性交',\\n                'personal-interactions': '自慰',\\n                'group-interactions': '群交',\\n                'highlight-moments': '高潮',\\n                'special-status': '受孕状态',\\n                'event-record': '破处记录',\\n                'memory-record': '重要备注'\\n            };\\n            \\n            // 当前使用的标签（从localStorage加载或使用默认值）\\n            let currentLabels = {};\\n            \\n            // 加载自定义标签\\n            function loadCustomLabels() {\\n                try {\\n                    const savedLabels = localStorage.getItem('customLabels');\\n                    if (savedLabels) {\\n                        currentLabels = JSON.parse(savedLabels);\\n                    } else {\\n                        currentLabels = {...defaultLabels};\\n                    }\\n                } catch (error) {\\n                    console.error('加载自定义标签出错:', error);\\n                    currentLabels = {...defaultLabels};\\n                }\\n                \\n                // 更新设置面板中的输入框\\n                updateSettingsInputs();\\n                \\n                // 如果页面已经加载完成，更新页面上的标签\\n                updateAllLabels();\\n            }\\n            \\n            // 更新设置面板中的输入框\\n            function updateSettingsInputs() {\\n                Object.keys(defaultLabels).forEach(key => {\\n                    const input = document.getElementById(`setting-${key}`);\\n                    if (input) {\\n                        input.value = currentLabels[key] || defaultLabels[key];\\n                    }\\n                });\\n            }\\n            \\n            // 更新页面中的所有标签\\n            function updateAllLabels() {\\n                // 更新雷达图标签\\n                if (psychologicalRadarChart) {\\n                    psychologicalRadarChart.data.labels = [\\n                        currentLabels['stability'] || defaultLabels['stability'],\\n                        currentLabels['care'] || defaultLabels['care'],\\n                        currentLabels['responsibility'] || defaultLabels['responsibility'],\\n                        currentLabels['alertness'] || defaultLabels['alertness'],\\n                        currentLabels['cooperation'] || defaultLabels['cooperation']\\n                    ];\\n                    psychologicalRadarChart.update();\\n                }\\n                \\n                // 更新状态标签文本\\n                const labelMappings = [\\n                    { id: 'vitality-label', key: 'vitality' },\\n                    { id: 'satisfaction-label', key: 'satisfaction' },\\n                    { id: 'cleanliness-label', key: 'cleanliness' },\\n                    { id: 'special-effect-label', key: 'special-effect' },\\n                    { id: 'stability-label', key: 'stability' },\\n                    { id: 'care-label', key: 'care' },\\n                    { id: 'responsibility-label', key: 'responsibility' },\\n                    { id: 'alertness-label', key: 'alertness' },\\n                    { id: 'cooperation-label', key: 'cooperation' },\\n                    { id: 'status-points-label', key: 'status-points' },\\n                    { id: 'excitement-label', key: 'excitement' },\\n                    { id: 'principle-label', key: 'principle' },\\n                    { id: 'autonomy-label', key: 'autonomy' },\\n                    { id: 'total-interactions-label', key: 'total-interactions' },\\n                    { id: 'interaction-a-label', key: 'interaction-a' },\\n                    { id: 'interaction-b-label', key: 'interaction-b' },\\n                    { id: 'interaction-c-label', key: 'interaction-c' },\\n                    { id: 'personal-interactions-label', key: 'personal-interactions' },\\n                    { id: 'group-interactions-label', key: 'group-interactions' },\\n                    { id: 'highlight-moments-label', key: 'highlight-moments' },\\n                    { id: 'special-status-label', key: 'special-status' },\\n                    { id: 'event-record-label', key: 'event-record' },\\n                    { id: 'memory-record-label', key: 'memory-record' }\\n                ];\\n                \\n                // 更新标题\\n                const titleMappings = [\\n                    { id: 'physiological-title', key: 'physiological-title' },\\n                    { id: 'psychological-title', key: 'psychological-title' },\\n                    { id: 'progress-title', key: 'progress-title' },\\n                    { id: 'behavior-title', key: 'behavior-title' }\\n                ];\\n                \\n                // 更新所有标签\\n                labelMappings.forEach(mapping => {\\n                    const element = document.getElementById(mapping.id);\\n                    if (element) {\\n                        element.textContent = currentLabels[mapping.key] || defaultLabels[mapping.key];\\n                    }\\n                });\\n                \\n                // 更新标题\\n                titleMappings.forEach(mapping => {\\n                    const element = document.getElementById(mapping.id);\\n                    if (element) {\\n                        element.textContent = currentLabels[mapping.key] || defaultLabels[mapping.key];\\n                    }\\n                });\\n            }\\n            \\n            // 保存自定义标签\\n            function saveCustomLabels() {\\n                try {\\n                    // 从设置面板的输入框中获取值\\n                    Object.keys(defaultLabels).forEach(key => {\\n                        const input = document.getElementById(`setting-${key}`);\\n                        if (input) {\\n                            currentLabels[key] = input.value || defaultLabels[key];\\n                        }\\n                    });\\n                    \\n                    // 保存到localStorage\\n                    localStorage.setItem('customLabels', JSON.stringify(currentLabels));\\n                    \\n                    // 更新页面上的标签\\n                    updateAllLabels();\\n                    \\n                    // 显示保存成功提示\\n                    const saveBtn = document.getElementById('save-settings');\\n                    const originalText = saveBtn.textContent;\\n                    saveBtn.textContent = '已保存';\\n                    setTimeout(() => {\\n                        saveBtn.textContent = originalText;\\n                    }, 1500);\\n                } catch (error) {\\n                    console.error('保存自定义标签出错:', error);\\n                    alert('保存设置失败，请重试');\\n                }\\n            }\\n            \\n            // 重置为默认标签\\n            function resetToDefaultLabels() {\\n                if (confirm('确定要恢复所有默认标签吗？')) {\\n                    // 重置为默认值\\n                    currentLabels = {...defaultLabels};\\n                    \\n                    // 保存到localStorage\\n                    localStorage.setItem('customLabels', JSON.stringify(currentLabels));\\n                    \\n                    // 更新设置面板中的输入框\\n                    updateSettingsInputs();\\n                    \\n                    // 更新页面上的标签\\n                    updateAllLabels();\\n                }\\n            }\\n            \\n            // 设置面板开关\\n            function setupSettingsPanel() {\\n                const settingsIcon = document.getElementById('settings-icon');\\n                const settingsPanel = document.getElementById('settings-panel');\\n                const settingsOverlay = document.getElementById('settings-overlay');\\n                const settingsClose = document.getElementById('settings-close');\\n                const saveSettings = document.getElementById('save-settings');\\n                const resetSettings = document.getElementById('reset-settings');\\n                \\n                // 点击设置图标打开面板\\n                settingsIcon.addEventListener('click', function() {\\n                    settingsPanel.classList.add('active');\\n                    settingsOverlay.classList.add('active');\\n                });\\n                \\n                // 点击关闭按钮关闭面板\\n                settingsClose.addEventListener('click', function() {\\n                    settingsPanel.classList.remove('active');\\n                    settingsOverlay.classList.remove('active');\\n                });\\n                \\n                // 点击遮罩层关闭面板\\n                settingsOverlay.addEventListener('click', function() {\\n                    settingsPanel.classList.remove('active');\\n                    settingsOverlay.classList.remove('active');\\n                });\\n                \\n                // 点击保存按钮保存设置\\n                saveSettings.addEventListener('click', saveCustomLabels);\\n                \\n                // 点击重置按钮重置为默认设置\\n                resetSettings.addEventListener('click', resetToDefaultLabels);\\n                \\n                // 初始化加载自定义标签\\n                loadCustomLabels();\\n            }\\n            \\n            // 初始化时调用\\n            setupSettingsPanel();\\n            \\n            // 启动检测\\n            setupAutoCheck();\\n            \\n            // 在控制台显示一条确认消息\\n            console.log('设置面板功能已初始化，可以通过右上角的齿轮图标访问');\\n            \\n            // 添加角色导航按钮事件监听\\n            document.getElementById('prev-character').addEventListener('click', function() {\\n                if (!this.classList.contains('disabled')) {\\n                    prevCharacter();\\n                }\\n            });\\n            \\n            document.getElementById('next-character').addEventListener('click', function() {\\n                if (!this.classList.contains('disabled')) {\\n                    nextCharacter();\\n                }\\n            });\\n        });\\n    </script>\\n</body>\\n</html>\\n```\",\"trimStrings\":[],\"placement\":[2],\"disabled\":false,\"markdownOnly\":true,\"promptOnly\":false,\"runOnEdit\":true,\"substituteRegex\":0,\"minDepth\":null,\"maxDepth\":null}]},\"group_only_greetings\":[],\"character_book\":{\"entries\":[{\"id\":0,\"keys\":[],\"secondary_keys\":[],\"comment\":\"有选项框版本\",\"content\":\"请严格按照以下格式生成回应内容。所有输出**必须**包含在一对 `<content>` 标签内部。\\n\\n**格式结构:**\\n\\n<content>\\n[DT:YYYY年MM月DD日][TM:HH:MM AM/PM][WK:星期X][TMP:温度°C][POS:地点名称]\\n\\n(在此处放置主要叙事文本。这部分文本应位于上方的信息标签和下方的第一个 `<StatusBlocks>` 标签之间。\\n注意排版要美观!禁止使用Markdown格式,文字不要扎堆)\\n\\n<StatusBlocks>\\n[角色名称1][头像URL1][体力值1(例: 75/100)][饥饿度1(例: 80/100)][清洁度1(例: 95/100)][药物影响1][SAN值1(例: 60/100)][羞耻心1(例: 50/100)][罪恶感1(例: 70/100)][恐惧感1(例: 40/100)][屈服度1(例: 65/100)][堕落值1(例: 30/100)][淫欲度1(例: 55/100)][贞操观念1(例: 85/100)][抗拒度1(例: 70/100)][性行为总次数1(数字)][口交次数1(数字)][肛交次数1(数字)][阴道性交次数1(数字)][自慰次数1(数字)][群交次数1(数字)][高超次数1(数字)][受孕状态文本1][破处记录文本1][重要备注文本1][ST:年龄文本1a][ST:心情,外观状态文本1b][ST:衣着文本1c][ST:内心想法文本1d]\\n</StatusBlocks>\\n\\n(可选: 在此处为其他角色添加更多的 `<StatusBlocks>` 部分，仅限出场角色女性,禁止出现男性!\\n每个角色都遵循与上方完全相同的格式。)\\n\\n\\n\\n<Checkbox>\\n[选项1][选项2][选项3][选项4]\\n</Checkbox>\\n</content>\\n\\n**生成要求:**\\n\\n1.  **严格遵守:** 请务必遵循上述确切的结构和标签用法 (`<content>`, `<StatusBlocks>`, `<Checkbox>`)。\\n2.  **信息标签:** 填写 `[DT:]`, `[TM:]`, `[WK:]`, `[TMP:]`, `[POS:]` 标签，包含与叙事相关的实际信息。\\n3.  **叙事文本:** 在指定区域撰写一段故事文本。\\n4.  **状态区块 (`<StatusBlocks>`)**:\\n    *   为每个角色创建一个 `<StatusBlocks>` 部分。\\n    *   在每个区块内部，**必须按照示例格式中列出的精确顺序**提供 25 个或更多用方括号 `[...]` 包裹的数据项。\\n    *   将 `角色名称1`、`头像URL1` 等占位符替换为实际数据。\\n    *   对于百分比类状态，使用 \\\"当前值/最大值\\\" 格式 (例如: \\\"80/100\\\",最大值固定为100)。\\n    *   对于互动计数，使用纯数字。\\n    *   为基于文本的字段提供描述性文本。\\n    *   尽可能使用有效的头像URL，或者使用占位符URL，如 `https://via.placeholder.com/200x200?text=无图像`。\\n    *   禁止留空,例如重要备注如果没有,请填写无,而不是不写!\\n    *   **至关重要:** 在每个 Status Block 的末尾，包含四个以 `[ST:...]` 开头的项目，用于角色的基本信息。\\n5.  **选择框 (`<Checkbox>`)**: 包含 `<Checkbox>` 部分，并在其中放入 3 到 4 个相关的{{user}}选项，每个选项都用方括号 `[...]` 包裹,选项要导向如何更好地让女主角堕落和调教。\\n6.  **完整性:** 确保所有标签都正确打开和关闭，并且 `<StatusBlocks>` 内所有必需的项目都存在且顺序正确无误。\\n\\n**状态区块结构示例 (用于参考内部顺序):**\\n`<content>\\n[DT:2024年07月26日][TM:10:15 AM][WK:星期五][TMP:18°C][POS:林哲家地下室]\\n\\n爱花试图坐起身，但身体却有些不听使唤，四肢酸软无力。她挣扎了几下，才勉强用手肘支撑起上半身，单薄的校服衬衫紧贴着微凉的肌肤。那标志性的白色蝴蝶结歪斜地挂在她的马尾辫一侧，几缕黑发散落在脸颊旁，更衬得她小脸苍白，眼神中充满了茫然与一丝不易察觉的惊惶。她呆呆地坐在那里，黑色眼眸茫然地扫视着这个完全陌生的、冰冷的地下室。\\n\\n<StatusBlocks>\\n[高岭爱花][https://files.catbox.moe/xkjf9e.png][85/100][70/100][90/100][迷药效果残留，意识模糊，轻微头痛][65/100][80/100][75/100][60/100][5/100][10/100][20/100][95/100][90/100][0][0][0][0][0][0][0][未受孕][处女][被迷晕带到陌生地下室，刚苏醒][ST:16岁][ST:迷茫，困惑，轻微恐惧，身体虚弱][ST:十羽野高中校服（夏装），白色蝴蝶结单马尾歪斜][ST:这是哪里？发生了什么？身体好无力……]\\n</StatusBlocks>\\n\\n<Checkbox>\\n[上前查看爱花的情况][暂时在暗处观察她的反应][弄出点声音试探她][给她盖上毯子]\\n</Checkbox>\\n</content>`\",\"constant\":true,\"selective\":true,\"insertion_order\":100,\"enabled\":true,\"position\":\"after_char\",\"use_regex\":true,\"extensions\":{\"position\":4,\"exclude_recursion\":false,\"display_index\":0,\"probability\":100,\"useProbability\":true,\"depth\":0,\"selectiveLogic\":0,\"group\":\"\",\"group_override\":false,\"group_weight\":100,\"prevent_recursion\":false,\"delay_until_recursion\":false,\"scan_depth\":null,\"match_whole_words\":null,\"use_group_scoring\":false,\"case_sensitive\":null,\"automation_id\":\"\",\"role\":0,\"vectorized\":false,\"sticky\":0,\"cooldown\":0,\"delay\":0}},{\"id\":1,\"keys\":[],\"secondary_keys\":[],\"comment\":\"无选项框版本\",\"content\":\"请严格按照以下格式生成回应内容。所有输出**必须**包含在一对 `<content>` 标签内部。\\n\\n**格式结构:**\\n\\n<content>\\n[DT:YYYY年MM月DD日][TM:HH:MM AM/PM][WK:星期X][TMP:温度°C][POS:地点名称]\\n\\n(在此处放置主要叙事文本。这部分文本应位于上方的信息标签和下方的第一个 `<StatusBlocks>` 标签之间。\\n注意排版!禁止使用Markdown格式,文字不要扎堆)\\n\\n<StatusBlocks>\\n[角色名称1][头像URL1][体力值1(例: 75/100)][饥饿度1(例: 80/100)][清洁度1(例: 95/100)][药物影响1][SAN值1(例: 60/100)][羞耻心1(例: 50/100)][罪恶感1(例: 70/100)][恐惧感1(例: 40/100)][屈服度1(例: 65/100)][堕落值1(例: 30/100)][淫欲度1(例: 55/100)][贞操观念1(例: 85/100)][抗拒度1(例: 70/100)][性行为总次数1(数字)][口交次数1(数字)][肛交次数1(数字)][阴道性交次数1(数字)][自慰次数1(数字)][群交次数1(数字)][高超次数1(数字)][受孕状态文本1][破处记录文本1][重要备注文本1][ST:年龄文本1a][ST:心情,外观状态文本1b][ST:衣着文本1c][ST:内心想法文本1d]\\n</StatusBlocks>\\n\\n(可选: 在此处为其他角色添加更多的 `<StatusBlocks>` 部分，仅限出场角色女性,禁止出现男性!\\n每个角色都遵循与上方完全相同的格式。)\\n\\n</content>\\n\\n**生成要求:**\\n\\n1.  **严格遵守:** 请务必遵循上述确切的结构和标签用法 (`<content>`, `<StatusBlocks>`, `<Checkbox>`)。\\n2.  **信息标签:** 填写 `[DT:]`, `[TM:]`, `[WK:]`, `[TMP:]`, `[POS:]` 标签，包含与叙事相关的实际信息。\\n3.  **叙事文本:** 在指定区域撰写一段故事文本。\\n4.  **状态区块 (`<StatusBlocks>`)**:\\n    *   为每个角色创建一个 `<StatusBlocks>` 部分。\\n    *   在每个区块内部，**必须按照示例格式中列出的精确顺序**提供 25 个或更多用方括号 `[...]` 包裹的数据项。\\n    *   将 `角色名称1`、`头像URL1` 等占位符替换为实际数据。\\n    *   对于百分比类状态，使用 \\\"当前值/最大值\\\" 格式 (例如: \\\"80/100\\\",最大值固定为100)。\\n    *   对于互动计数，使用纯数字。\\n    *   为基于文本的字段提供描述性文本。\\n    *   尽可能使用有效的头像URL，或者使用占位符URL，如 `https://via.placeholder.com/200x200?text=无图像`。\\n    *   禁止留空,例如重要备注如果没有,请填写无,而不是不写!\\n    *   **至关重要:** 在每个 Status Block 的末尾，包含四个以 `[ST:...]` 开头的项目，用于角色的基本信息。\\n\\n5.  **完整性:** 确保所有标签都正确打开和关闭，并且 `<StatusBlocks>` 内所有必需的项目都存在且顺序正确无误。\\n\\n**状态区块结构示例 (用于参考内部顺序):**\\n`<content>\\n[DT:2024年07月26日][TM:10:15 AM][WK:星期五][TMP:18°C][POS:林哲家地下室]\\n\\n爱花试图坐起身，但身体却有些不听使唤，四肢酸软无力。她挣扎了几下，才勉强用手肘支撑起上半身，单薄的校服衬衫紧贴着微凉的肌肤。那标志性的白色蝴蝶结歪斜地挂在她的马尾辫一侧，几缕黑发散落在脸颊旁，更衬得她小脸苍白，眼神中充满了茫然与一丝不易察觉的惊惶。她呆呆地坐在那里，黑色眼眸茫然地扫视着这个完全陌生的、冰冷的地下室。\\n\\n<StatusBlocks>\\n[高岭爱花][https://files.catbox.moe/xkjf9e.png][85/100][70/100][90/100][迷药效果残留，意识模糊，轻微头痛][65/100][80/100][75/100][60/100][5/100][10/100][20/100][95/100][90/100][0][0][0][0][0][0][0][未受孕][处女][被迷晕带到陌生地下室，刚苏醒][ST:16岁][ST:迷茫，困惑，轻微恐惧，身体虚弱][ST:十羽野高中校服（夏装），白色蝴蝶结单马尾歪斜][ST:这是哪里？发生了什么？身体好无力……]\\n</StatusBlocks>\\n\\n</content>`\",\"constant\":true,\"selective\":true,\"insertion_order\":100,\"enabled\":false,\"position\":\"after_char\",\"use_regex\":true,\"extensions\":{\"position\":4,\"exclude_recursion\":false,\"display_index\":0,\"probability\":100,\"useProbability\":true,\"depth\":0,\"selectiveLogic\":0,\"group\":\"\",\"group_override\":false,\"group_weight\":100,\"prevent_recursion\":false,\"delay_until_recursion\":false,\"scan_depth\":null,\"match_whole_words\":null,\"use_group_scoring\":false,\"case_sensitive\":null,\"automation_id\":\"\",\"role\":0,\"vectorized\":false,\"sticky\":0,\"cooldown\":0,\"delay\":0}},{\"id\":2,\"keys\":[],\"secondary_keys\":[],\"comment\":\"数值备注(开不开随意,或者自己改)\",\"content\":\" **一、 基础生理状态**\\n\\n *   **体力值:**\\n     *   表示角色当前的身体能量或健康状况。\\n     *   影响：进行特定活动（如反抗、逃跑、长时间性行为）会消耗体力，过低可能导致行动受限或晕厥。\\n *   **饥饿度:**\\n     *   表示角色的饱腹程度。\\n     *   影响：过低可能导致体力恢复减慢，甚至影响情绪。\\n *   **清洁度:**\\n     *   表示角色的身体清洁状况。\\n     *   影响：可能影响他人对其的评价，或解锁特定事件（如沐浴）。\\n *   **药物影响:**\\n     *   显示当前是否受到特定药物（如催情药、安眠药）的影响及其程度/持续时间。\\n     *   影响：会改变角色的行为能力、意识状态或生理反应。\\n\\n **二、 核心心理状态**\\n\\n *   **SAN值:**\\n     *   衡量角色的精神稳定程度。\\n     *   影响：经历冲击性事件或长期处于压力下会降低，过低可能导致精神崩溃、行为异常或解锁负面结局。\\n *   **羞耻心:**\\n     *   表示角色对自身行为或处境感到的羞耻程度。\\n     *   影响：通常在游戏初期较高，随着“堕落”进程降低。高羞耻心可能导致反抗或逃避，低羞耻心则更容易接受或甚至享受现状。\\n *   **罪恶感:**\\n     *   主要针对伴侣或特定关系对象，表示背叛行为带来的心理负担。\\n     *   影响：可能影响与原伴侣的互动，或触发特定的内心挣扎剧情。\\n *   **恐惧感 :**\\n     *   对特定人物、环境或行为感到的恐惧程度。\\n     *   影响：可能导致回避、服从或触发应激反应。\\n *   **屈服度:**\\n     *   表示角色对他人意愿的顺从程度。\\n     *   影响：高屈服度使角色更易接受命令或不情愿的行为。\\n\\n **三、 调教核心数值**\\n\\n *   **堕落值:**\\n     *   **核心指标**，衡量角色偏离原有道德观念和行为准则的程度。\\n     *   影响：通常由经历各种调教事件、接受特定行为、心理状态变化等因素累积。高堕落值会解锁更深入的调教内容、改变角色的反应和对话，甚至影响结局。\\n *   **淫欲度:**\\n     *   表示角色对性行为的渴望程度或获得快感的难易度。\\n     *   影响：可能随着经历增加而提升，或因特定事件/药物改变。高淫欲度使角色更主动或更容易在性行为中获得满足。阈值降低则更容易达到高潮。\\n *   **贞操观念:**\\n     *   衡量角色对传统贞洁观念的认同程度。\\n     *   影响：通常初始较高，随游戏进程和堕落值变化而降低。影响角色对非伴侣性行为的态度和心理反应。\\n *   **抗拒度:**\\n     *   表示角色对不希望发生的事件的抵抗意愿和能力。\\n     *   影响：受体力、精神状态、恐惧感、屈服度等多种因素影响。高抗拒可能触发反抗剧情，低抗拒则更易顺从。\\n\\n **四、 行为记录与经验值**\\n\\n *   **性行为总次数:**\\n     *   记录所有性行为的总和。\\n *   **特定性行为经验/次数:**\\n     *   **口交次数:** \\n     *   **肛交次数:**\\n     *   **阴道性交次数:**\\n     *   **自慰次数:**\\n     *   **群交次数:**\\n     *   **特定场景/对象性行为次数:** 如：在XX地点发生的次数，与XX角色发生的次数。\\n     *   **首次经验记录:** 记录各种第一次（如第一次接吻、第一次性行为、第一次肛交等是与谁发生的）。\\n *   **高潮次数:**\\n     *   记录总高潮次数，有时会区分不同类型的性行为导致的高潮。\\n *   **受孕状态/几率:**\\n     *   显示是否怀孕，或当前的受孕风险。有时会关联胎儿的父亲身份。\\n *   **重要备注:**\\n     *   例如：**口交技巧**、**足交技巧**、**M倾向等级**、**露出癖等级** 等。这些通常通过重复特定行为来提升，解锁更高级的互动或反应。\",\"constant\":true,\"selective\":true,\"insertion_order\":100,\"enabled\":true,\"position\":\"after_char\",\"use_regex\":true,\"extensions\":{\"position\":4,\"exclude_recursion\":true,\"display_index\":2,\"probability\":100,\"useProbability\":true,\"depth\":4,\"selectiveLogic\":0,\"group\":\"\",\"group_override\":false,\"group_weight\":100,\"prevent_recursion\":true,\"delay_until_recursion\":false,\"scan_depth\":null,\"match_whole_words\":null,\"use_group_scoring\":false,\"case_sensitive\":null,\"automation_id\":\"\",\"role\":0,\"vectorized\":false,\"sticky\":0,\"cooldown\":0,\"delay\":0}}],\"name\":\"  [前端]调教状态栏+选项\"}},\"create_date\":\"2025-4-25 @14h 21m 21s 785ms\",\"chat\":\"[前端]调教状态栏+选项 - 2025-04-21@20h11m12s\"}"}